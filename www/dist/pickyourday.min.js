var app=angular.module("ar-toolkit",["ionic"]);angular.module("ar-toolkit").run(["$ionicPlatform",function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),angular.module("ar-toolkit").directive("arView",["ARUtils","ARCamera","AR",function(e,t,r){return{restrict:"A",link:function(n,a,o){var i=a[0];e.size(i),t.wait(function(){r.init(i),r.tick()})}}}]),angular.module("ar-toolkit").factory("AR3D",["ARObject",function(e){var t=function(e){function t(){o.needsUpdate=!0}var r=new THREE.Camera,n=new THREE.Scene,a=new THREE.PlaneGeometry(2,2,0),o=new THREE.Texture(e);o.generateMipmaps=!1,o.minFilter=THREE.NearestFilter,o.magFilter=THREE.NearestFilter,o.wrapS=o.wrapT=THREE.ClampToEdgeWrapping;var i=new THREE.MeshBasicMaterial({map:o,depthTest:!1,depthWrite:!1}),c=new THREE.Mesh(a,i);return n.add(c),{camera:r,scene:n,update:t}},r=function(){function e(e){n.add(e),console.log(n)}function t(e){n.remove(e)}function r(e){a.projectionMatrix.setFromArray(e)}var n=new THREE.Scene,a=new THREE.Camera;return{scene:n,camera:a,add:e,remove:t,setProjectionMatrix:r}},n=function(n,a,o){function i(){m.render(s.scene,s.camera),m.render(f.scene,f.camera)}function c(){s.update()}function u(e){f.add(e.model)}function d(e){f.setProjectionMatrix(e)}function l(e){f.remove(e.model)}var m=new THREE.WebGLRenderer({canvas:n});m.setSize(a.width,a.height),m.autoClear=!1;var s=new t(o),f=new r,g=new THREE.SpotLight(16777215);g.position.set(0,0,9e3),g.lookAt(new THREE.Vector3(0,0,0)),f.scene.add(g);var w=e.create({color:13369344});return f.add(w.model),{add:u,remove:l,update:c,render:i,glCanvas:n,setCameraMatrix:d}};return{create:n}}]),angular.module("ar-toolkit").factory("ARCamera",["ARUtils",function(e){var t=document.getElementById("video");e.size(t);var r=function(e,t,r){var n=void 0;return navigator.getUserMedia?n=navigator.getUserMedia(e,t,r):navigator.webkitGetUserMedia&&(n=navigator.webkitGetUserMedia(e,t,r)),n},n=function(e){return function(r){var n=window.URL||window.webkitURL;t.src=n.createObjectURL(r),t.play(),e()}},a=function(e){console.log("An error occured! "+e)},o=function(e){r({video:!0,audio:!1},n(e),a)},i=function(){return{width:t.width,height:t.height}},c=function(e){e.drawImage(t,0,0)};return{wait:o,copyToContext:c,getDimensions:i}}]),angular.module("ar-toolkit").factory("ARDetector",function(){function e(e){var t=new NyARRgbRaster_Canvas2D(e),r=new FLARParam(e.width,e.height),n=new FLARMultiIdMarkerDetector(r,120);n.setContinueMode(!0);var a=function(e){var t=n.getIdMarkerData(e);if(t.packetLength>4)return-1;for(var r=0,a=0;a<t.packetLength;a++)r=r<<8|t.getPacketData(a);return r},o=function(e){var t=new NyARTransMatResult;n.getTransformMatrix(e,t);var r=new Float32Array(16);return r[0]=t.m00,r[1]=-t.m10,r[2]=t.m20,r[3]=0,r[4]=t.m01,r[5]=-t.m11,r[6]=t.m21,r[7]=0,r[8]=-t.m02,r[9]=t.m12,r[10]=-t.m22,r[11]=0,r[12]=t.m03,r[13]=-t.m13,r[14]=t.m23,r[15]=1,r},i=function(e,t){var n=new Float32Array(16);return r.copyCameraMatrix(n,e,t),n},c=1,u=function(e,t){return{id:e,matrix:t,age:c}},d={},l=function(e,r,i){for(var l=n.detectMarkerLite(t,70),m=0;l>m;m++){var s=a(m),f=d[s];void 0===f?(f=u(s,o(m)),d[s]=f,e(f)):(f.matrix=o(m),f.age=c,r(f))}for(var s in d){var f=d[s];f&&0==f.age--&&(i(f),delete d[s])}};return{detect:l,getCameraMatrix:i}}return{create:e}}),angular.module("ar-toolkit").factory("AR",["ARCamera","ARDetector","AR3D","ARMarker",function(e,t,r,n){var a,o,i,c,u=function(n){a=document.createElement("canvas");var u=e.getDimensions();console.log(u),a.width=u.width,a.height=u.height,o=a.getContext("2d"),i=t.create(a),c=r.create(n,u,a),c.setCameraMatrix(i.getCameraMatrix(10,1e3))},d=function(){e.copyToContext(o),a.changed=!0,i.detect(n.onCreate(c),n.onUpdate(c),n.onDestroy(c)),c.update(),c.render(),window.requestAnimationFrame(d)};return{init:u,tick:d}}]),angular.module("ar-toolkit").factory("ARMarker",["ARObject",function(e){var t={16:e.create({color:13369344}),32:e.create({color:52224}),64:e.create({color:204})},r=function(e){return function(r){console.log("Created"),console.log(r.id);var n=t[r.id];n.transform(r.matrix),e.add(n)}},n=function(e){return function(e){console.log("update"),console.log(e.id);var r=t[e.id];r.transform(e.matrix)}},a=function(e){return function(r){console.log("remove"),console.log(r.id);var n=t[r.id];e.remove(n)}};return{onCreate:r,onUpdate:n,onDestroy:a}}]),angular.module("ar-toolkit").factory("ARObject",function(){function e(){var e=new THREE.Object3D;return e.matrixAutoUpdate=!1,e}function t(e){var t=new THREE.CubeGeometry(100,100,100),r=new THREE.MeshPhongMaterial({color:e,side:THREE.DoubleSide}),n=new THREE.Mesh(t,r);return n.position.z=-40,n}function r(r){function n(e){a.transformFromArray(e)}var a=e(),o=t(r.color);return a.add(o),{transform:n,model:a}}return{create:r}}),angular.module("ar-toolkit").factory("ARUtils",["$ionicPlatform",function(e){return{size:function(t){t.width=window.innerWidth,t.height=window.innerHeight,e.ready(function(){t.width=window.innerWidth,t.height=window.innerHeight})}}}]),THREE.Matrix4.prototype.setFromArray=function(e){return this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},THREE.Object3D.prototype.transformFromArray=function(e){this.matrix.setFromArray(e),this.matrixWorldNeedsUpdate=!0};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbmZpZy9ib290LmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL2FyX3ZpZXdfZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfM2RfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX2NhbWVyYV9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfZGV0ZWN0b3JfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl9tYXJrZXJfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX29iamVjdF9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfdXRpbHNfZmFjdG9yeS5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJGlvbmljUGxhdGZvcm0iLCJyZWFkeSIsIndpbmRvdyIsImNvcmRvdmEiLCJwbHVnaW5zIiwiS2V5Ym9hcmQiLCJoaWRlS2V5Ym9hcmRBY2Nlc3NvcnlCYXIiLCJkaXNhYmxlU2Nyb2xsIiwiU3RhdHVzQmFyIiwic3R5bGVEZWZhdWx0IiwiZGlyZWN0aXZlIiwiQVJVdGlscyIsIkFSQ2FtZXJhIiwiQVIiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsInRFbGVtZW50IiwiYXR0cnMiLCJlbGVtIiwic2l6ZSIsIndhaXQiLCJpbml0IiwidGljayIsImZhY3RvcnkiLCJBUk9iamVjdCIsIlJlYWxpdHkiLCJzb3VyY2VDYW52YXMiLCJ1cGRhdGUiLCJ0ZXh0dXJlIiwibmVlZHNVcGRhdGUiLCJjYW1lcmEiLCJUSFJFRSIsIkNhbWVyYSIsInNjZW5lIiwiU2NlbmUiLCJnZW9tZXRyeSIsIlBsYW5lR2VvbWV0cnkiLCJUZXh0dXJlIiwiZ2VuZXJhdGVNaXBtYXBzIiwibWluRmlsdGVyIiwiTmVhcmVzdEZpbHRlciIsIm1hZ0ZpbHRlciIsIndyYXBTIiwid3JhcFQiLCJDbGFtcFRvRWRnZVdyYXBwaW5nIiwibWF0ZXJpYWwiLCJNZXNoQmFzaWNNYXRlcmlhbCIsIm1hcCIsImRlcHRoVGVzdCIsImRlcHRoV3JpdGUiLCJtZXNoIiwiTWVzaCIsImFkZCIsIm9iamVjdCIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmUiLCJzZXRQcm9qZWN0aW9uTWF0cml4IiwibWF0cml4IiwicHJvamVjdGlvbk1hdHJpeCIsInNldEZyb21BcnJheSIsImNyZWF0ZSIsImdsQ2FudmFzIiwiZGltZW5zaW9ucyIsInJlbmRlciIsInJlbmRlcmVyIiwicmVhbGl0eSIsInZpcnR1YWwiLCJtb2RlbCIsInNldENhbWVyYU1hdHJpeCIsIldlYkdMUmVuZGVyZXIiLCJjYW52YXMiLCJzZXRTaXplIiwid2lkdGgiLCJoZWlnaHQiLCJhdXRvQ2xlYXIiLCJsaWdodCIsIlNwb3RMaWdodCIsInBvc2l0aW9uIiwic2V0IiwibG9va0F0IiwiVmVjdG9yMyIsIm9iaiIsImNvbG9yIiwidmlkZW8iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0TWVkaWFDYXB0dXJlIiwidCIsIm9uc3VjY2VzcyIsIm9uZXJyb3IiLCJyZXN1bHQiLCJ1bmRlZmluZWQiLCJuYXZpZ2F0b3IiLCJnZXRVc2VyTWVkaWEiLCJ3ZWJraXRHZXRVc2VyTWVkaWEiLCJvblN1Y2Nlc3MiLCJjYiIsInN0cmVhbSIsInZlbmRvclVSTCIsIlVSTCIsIndlYmtpdFVSTCIsInNyYyIsImNyZWF0ZU9iamVjdFVSTCIsInBsYXkiLCJvbkVycm9yIiwiZXJyIiwid2FpdENhbWVyYSIsImNhbGxiYWNrIiwiYXVkaW8iLCJnZXREaW1lbnNpb25zIiwiY29weVRvQ29udGV4dCIsImNvbnRleHQiLCJkcmF3SW1hZ2UiLCJKU0FSUmFzdGVyIiwiTnlBUlJnYlJhc3Rlcl9DYW52YXMyRCIsIkpTQVJQYXJhbWV0ZXJzIiwiRkxBUlBhcmFtIiwiSlNBUkRldGVjdG9yIiwiRkxBUk11bHRpSWRNYXJrZXJEZXRlY3RvciIsInNldENvbnRpbnVlTW9kZSIsImdldE1hcmtlck51bWJlciIsImlkeCIsImRhdGEiLCJnZXRJZE1hcmtlckRhdGEiLCJwYWNrZXRMZW5ndGgiLCJpIiwiZ2V0UGFja2V0RGF0YSIsImdldFRyYW5zZm9ybU1hdHJpeCIsIm1hdCIsIk55QVJUcmFuc01hdFJlc3VsdCIsImNtIiwiRmxvYXQzMkFycmF5IiwibTAwIiwibTEwIiwibTIwIiwibTAxIiwibTExIiwibTIxIiwibTAyIiwibTEyIiwibTIyIiwibTAzIiwibTEzIiwibTIzIiwiZ2V0Q2FtZXJhTWF0cml4Iiwiek5lYXIiLCJ6RmFyIiwiY29weUNhbWVyYU1hdHJpeCIsInBlcnNpc3RUaW1lIiwibmV3TWFya2VyIiwiaWQiLCJhZ2UiLCJtYXJrZXJzIiwiZGV0ZWN0Iiwib25DcmVhdGUiLCJvblVwZGF0ZSIsIm9uRGVzdHJveSIsIm1hcmtlckNvdW50IiwiZGV0ZWN0TWFya2VyTGl0ZSIsImluZGV4IiwibWFya2VyIiwiQVJEZXRlY3RvciIsIkFSM0QiLCJBUk1hcmtlciIsImRldGVjdG9yIiwidmlldyIsImNyZWF0ZUVsZW1lbnQiLCJjYW1lcmFEaW1lbnNpb25zIiwiZ2V0Q29udGV4dCIsImNoYW5nZWQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJvYmplY3RzIiwxNiwzMiw2NCwidHJhbnNmb3JtIiwiY3JlYXRlQ29udGFpbmVyIiwiT2JqZWN0M0QiLCJtYXRyaXhBdXRvVXBkYXRlIiwiY3JlYXRlTWFya2VyTWVzaCIsIkN1YmVHZW9tZXRyeSIsIk1lc2hQaG9uZ01hdGVyaWFsIiwic2lkZSIsIkRvdWJsZVNpZGUiLCJ6IiwiY3JlYXRlTWFya2VyT2JqZWN0IiwicGFyYW1zIiwibW9kZWxDb250YWluZXIiLCJ0cmFuc2Zvcm1Gcm9tQXJyYXkiLCJtb2RlbE1lc2giLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJNYXRyaXg0IiwicHJvdG90eXBlIiwibSIsInRoaXMiLCJtYXRyaXhXb3JsZE5lZWRzVXBkYXRlIl0sIm1hcHBpbmdz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QUFBVSxFQUdBLE9BRkFLLEdBQUE0QixTQUFBMkcsRUFBQSxJQUVBdkksRUFHQSxRQUFBd0ksR0FBQUMsR0FNQSxRQUFBWCxHQUFBdEgsR0FDQWtJLEVBQUFDLG1CQUFBbkksR0FOQSxHQUFBa0ksR0FBQVgsSUFFQWEsRUFBQVYsRUFBQU8sRUFBQXhHLE1BT0EsT0FOQXlHLEdBQUF4SSxJQUFBMEksSUFPQWQsVUFBQUEsRUFDQTVHLE1BQUF3SCxHQUtBLE9BQ0EvSCxPQUFBNkgsS0NyQ0E5TCxRQUFBQyxPQUFBLGNBQ0EwQixRQUFBLFdBQUEsaUJBQUEsU0FBQXhCLEdBRUEsT0FDQW9CLEtBQUEsU0FBQUQsR0FDQUEsRUFBQXVELE1BQUF4RSxPQUFBOEwsV0FDQTdLLEVBQUF3RCxPQUFBekUsT0FBQStMLFlBRUFqTSxFQUFBQyxNQUFBLFdBQ0FrQixFQUFBdUQsTUFBQXhFLE9BQUE4TCxXQUNBN0ssRUFBQXdELE9BQUF6RSxPQUFBK0wsbUJBTUFqSyxNQUFBa0ssUUFBQUMsVUFBQXRJLGFBQUEsU0FBQXVJLEdBQ0EsTUFBQUMsTUFBQXJILElBQ0FvSCxFQUFBLEdBQUFBLEVBQUEsR0FBQUEsRUFBQSxHQUFBQSxFQUFBLElBQ0FBLEVBQUEsR0FBQUEsRUFBQSxHQUFBQSxFQUFBLEdBQUFBLEVBQUEsSUFDQUEsRUFBQSxHQUFBQSxFQUFBLEdBQUFBLEVBQUEsSUFBQUEsRUFBQSxJQUNBQSxFQUFBLEdBQUFBLEVBQUEsR0FBQUEsRUFBQSxJQUFBQSxFQUFBLE1BSUFwSyxNQUFBbUosU0FBQWdCLFVBQUFMLG1CQUFBLFNBQUFNLEdBQ0FDLEtBQUExSSxPQUFBRSxhQUFBdUksR0FDQUMsS0FBQUMsd0JBQUEiLCJmaWxlIjoicGlja3lvdXJkYXkubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcD1hbmd1bGFyLm1vZHVsZSgnYXItdG9vbGtpdCcsIFsnaW9uaWMnXSlcblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXItdG9vbGtpdCcpXHJcbi5ydW4oZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0pIHtcclxuICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgIGlmKHdpbmRvdy5jb3Jkb3ZhICYmIHdpbmRvdy5jb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQpIHtcclxuICAgICAgLy8gSGlkZSB0aGUgYWNjZXNzb3J5IGJhciBieSBkZWZhdWx0IChyZW1vdmUgdGhpcyB0byBzaG93IHRoZSBhY2Nlc3NvcnkgYmFyIGFib3ZlIHRoZSBrZXlib2FyZFxyXG4gICAgICAvLyBmb3IgZm9ybSBpbnB1dHMpXHJcbiAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5oaWRlS2V5Ym9hcmRBY2Nlc3NvcnlCYXIodHJ1ZSk7XHJcblxyXG4gICAgICAvLyBEb24ndCByZW1vdmUgdGhpcyBsaW5lIHVubGVzcyB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmcuIEl0IHN0b3BzIHRoZSB2aWV3cG9ydFxyXG4gICAgICAvLyBmcm9tIHNuYXBwaW5nIHdoZW4gdGV4dCBpbnB1dHMgYXJlIGZvY3VzZWQuIElvbmljIGhhbmRsZXMgdGhpcyBpbnRlcm5hbGx5IGZvclxyXG4gICAgICAvLyBhIG11Y2ggbmljZXIga2V5Ym9hcmQgZXhwZXJpZW5jZS5cclxuICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmRpc2FibGVTY3JvbGwodHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBpZih3aW5kb3cuU3RhdHVzQmFyKSB7XHJcbiAgICAgIFN0YXR1c0Jhci5zdHlsZURlZmF1bHQoKTtcclxuICAgIH1cclxuICB9KTtcclxuICAgIFxyXG4gICAgXHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmRpcmVjdGl2ZSgnYXJWaWV3JywgZnVuY3Rpb24oQVJVdGlscywgQVJDYW1lcmEsIEFSKSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6ZnVuY3Rpb24oc2NvcGUsIHRFbGVtZW50LCBhdHRycyl7XHJcbiAgICAgICAgICAgIHZhciBlbGVtPXRFbGVtZW50WzBdO1xyXG4gICAgICAgICAgICAgIEFSVXRpbHMuc2l6ZShlbGVtKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIEFSQ2FtZXJhLndhaXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIEFSLmluaXQoZWxlbSk7XHJcbiAgICAgICAgICAgICAgICBBUi50aWNrKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUjNEJywgZnVuY3Rpb24oQVJPYmplY3QpIHtcclxuXHJcblxyXG4gICAgdmFyIFJlYWxpdHk9ZnVuY3Rpb24oc291cmNlQ2FudmFzKXtcclxuXHJcbiAgICAgICAgdmFyIGNhbWVyYT0gbmV3IFRIUkVFLkNhbWVyYSgpO1xyXG4gICAgICAgIHZhciBzY2VuZT0gbmV3IFRIUkVFLlNjZW5lKCk7XHJcblxyXG4gICAgICAgIHZhciBnZW9tZXRyeT0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoMiwyLDApO1xyXG4gICAgICAgIHZhciB0ZXh0dXJlPW5ldyBUSFJFRS5UZXh0dXJlKHNvdXJjZUNhbnZhcyk7XHJcbiAgICAgICAgdGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMgPSBmYWxzZTtcclxuICAgICAgICB0ZXh0dXJlLm1pbkZpbHRlciA9IFRIUkVFLk5lYXJlc3RGaWx0ZXI7XHJcbiAgICAgICAgdGV4dHVyZS5tYWdGaWx0ZXIgPSBUSFJFRS5OZWFyZXN0RmlsdGVyO1xyXG4gICAgICAgIHRleHR1cmUud3JhcFMgPSB0ZXh0dXJlLndyYXBUID1USFJFRS5DbGFtcFRvRWRnZVdyYXBwaW5nO1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG5cclxuXHJcbiAgICAgICAgdmFyIG1hdGVyaWFsPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgICBtYXA6dGV4dHVyZSxcclxuICAgICAgICAgICAgZGVwdGhUZXN0OmZhbHNlLFxyXG4gICAgICAgICAgICBkZXB0aFdyaXRlOmZhbHNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBtZXNoPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIHNjZW5lLmFkZChtZXNoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlKCl7XHJcbiAgICAgICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGU9dHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNhbWVyYTogY2FtZXJhLFxyXG4gICAgICAgICAgICBzY2VuZTogc2NlbmUsXHJcbiAgICAgICAgICAgIHVwZGF0ZTogdXBkYXRlLCBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBTY2VuZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xyXG4gICAgICAgIHZhciBjYW1lcmEgPSBuZXcgVEhSRUUuQ2FtZXJhKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFkZChvYmplY3QpIHtcclxuICAgICAgICAgXHJcbiAgICAgICAgICAgIHNjZW5lLmFkZChvYmplY3QpO1xyXG4gICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzY2VuZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKG9iamVjdCkge1xyXG4gICAgICAgICAgICBzY2VuZS5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldFByb2plY3Rpb25NYXRyaXgobWF0cml4KSB7XHJcbiAgICAgICAgICAgIGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LnNldEZyb21BcnJheSggbWF0cml4ICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzY2VuZTpzY2VuZSxcclxuICAgICAgICAgICAgY2FtZXJhOmNhbWVyYSxcclxuICAgICAgICAgICAgYWRkOmFkZCxcclxuICAgICAgICAgICAgcmVtb3ZlOnJlbW92ZSxcclxuICAgICAgICAgICAgc2V0UHJvamVjdGlvbk1hdHJpeDpzZXRQcm9qZWN0aW9uTWF0cml4LFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIGNyZWF0ZT1mdW5jdGlvbihnbENhbnZhcywgZGltZW5zaW9ucywgc291cmNlQ2FudmFzKXtcclxuXHJcbiAgICAgICAgdmFyIHJlbmRlcmVyPW5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHtjYW52YXM6Z2xDYW52YXN9KTtcclxuICAgICAgICByZW5kZXJlci5zZXRTaXplKGRpbWVuc2lvbnMud2lkdGgsIGRpbWVuc2lvbnMuaGVpZ2h0KTtcclxuICAgICAgICByZW5kZXJlci5hdXRvQ2xlYXI9ZmFsc2U7XHJcblxyXG4gICAgICAgIHZhciByZWFsaXR5PSBuZXcgUmVhbGl0eShzb3VyY2VDYW52YXMpO1xyXG4gICAgICAgIHZhciB2aXJ0dWFsPSBuZXcgU2NlbmUoKTtcclxuXHJcbiAgICAgICAgdmFyIGxpZ2h0PW5ldyBUSFJFRS5TcG90TGlnaHQoMHhmZmZmZmYpO1xyXG4gICAgICAgIGxpZ2h0LnBvc2l0aW9uLnNldCgwLDAsOTAwMCk7XHJcbiAgICAgICAgbGlnaHQubG9va0F0KG5ldyBUSFJFRS5WZWN0b3IzKDAsMCwwKSk7XHJcbiAgICAgICAgdmlydHVhbC5zY2VuZS5hZGQobGlnaHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBvYmo9QVJPYmplY3QuY3JlYXRlKHtjb2xvcjoweENDMDAwMH0pO1xyXG4gICAgICAgIHZpcnR1YWwuYWRkKG9iai5tb2RlbCk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcigpe1xyXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXIocmVhbGl0eS5zY2VuZSwgcmVhbGl0eS5jYW1lcmEpO1xyXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXIodmlydHVhbC5zY2VuZSwgdmlydHVhbC5jYW1lcmEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlKCl7XHJcbiAgICAgICAgICAgIHJlYWxpdHkudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGQob2JqZWN0KXtcclxuICAgICAgICAgICAgdmlydHVhbC5hZGQob2JqZWN0Lm1vZGVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2FtZXJhTWF0cml4KCBtYXRyaXggKSB7XHJcbiAgICAgICAgICAgIHZpcnR1YWwuc2V0UHJvamVjdGlvbk1hdHJpeCggbWF0cml4ICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmUob2JqZWN0KXtcclxuICAgICAgICAgICAgdmlydHVhbC5yZW1vdmUob2JqZWN0Lm1vZGVsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGFkZDogYWRkLFxyXG4gICAgICAgICAgICByZW1vdmU6IHJlbW92ZSxcclxuICAgICAgICAgICAgdXBkYXRlOiB1cGRhdGUsXHJcbiAgICAgICAgICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgICAgICAgICBnbENhbnZhczogZ2xDYW52YXMsXHJcbiAgICAgICAgICAgIHNldENhbWVyYU1hdHJpeDogc2V0Q2FtZXJhTWF0cml4LFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjcmVhdGU6Y3JlYXRlXHJcbiAgICB9XHJcblxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXItdG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeSgnQVJDYW1lcmEnLCBmdW5jdGlvbiggQVJVdGlscykge1xyXG5cclxuICAgIHZhciB2aWRlbz0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZGVvJyk7XHJcbiAgICBBUlV0aWxzLnNpemUodmlkZW8pO1xyXG5cclxuICAgIHZhciBnZXRNZWRpYUNhcHR1cmUgPSBmdW5jdGlvbih0LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmIChuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEodCwgb25zdWNjZXNzLCBvbmVycm9yKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSh0LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpO1xyXG4gICAgICAgIH0gXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG9uU3VjY2Vzcz1mdW5jdGlvbihjYil7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmVhbSl7XHJcbiAgICAgICAgICAgIHZhciB2ZW5kb3JVUkwgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkw7XHJcbiAgICAgICAgICAgIHZpZGVvLnNyYyA9IHZlbmRvclVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTtcclxuICAgICAgICAgICAgdmlkZW8ucGxheSgpO1xyXG4gICAgICAgICAgICBjYigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICB2YXIgb25FcnJvcj1mdW5jdGlvbihlcnIpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQW4gZXJyb3Igb2NjdXJlZCEgXCIgKyBlcnIpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICB2YXIgd2FpdENhbWVyYT1mdW5jdGlvbihjYWxsYmFjayl7XHJcblxyXG4gICAgICAgIGdldE1lZGlhQ2FwdHVyZSh7dmlkZW86IHRydWUsYXVkaW86IGZhbHNlfSwgb25TdWNjZXNzKGNhbGxiYWNrKSwgb25FcnJvcik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhciBnZXREaW1lbnNpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgd2lkdGg6dmlkZW8ud2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDp2aWRlby5oZWlnaHRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNvcHlUb0NvbnRleHQ9ZnVuY3Rpb24oY29udGV4dCl7XHJcbiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UodmlkZW8sIDAsMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB3YWl0OndhaXRDYW1lcmEsXHJcbiAgICAgICAgY29weVRvQ29udGV4dDpjb3B5VG9Db250ZXh0LFxyXG4gICAgICAgIGdldERpbWVuc2lvbnM6Z2V0RGltZW5zaW9uc1xyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSRGV0ZWN0b3InLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGUoc291cmNlQ2FudmFzKXtcclxuICAgICAgIHZhciBKU0FSUmFzdGVyID0gbmV3IE55QVJSZ2JSYXN0ZXJfQ2FudmFzMkQoc291cmNlQ2FudmFzKTtcclxuICAgICAgICB2YXIgSlNBUlBhcmFtZXRlcnMgPSBuZXcgRkxBUlBhcmFtKHNvdXJjZUNhbnZhcy53aWR0aCwgc291cmNlQ2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIEpTQVJEZXRlY3RvciA9IG5ldyBGTEFSTXVsdGlJZE1hcmtlckRldGVjdG9yKEpTQVJQYXJhbWV0ZXJzLCAxMjApO1xyXG4gICAgICAgIEpTQVJEZXRlY3Rvci5zZXRDb250aW51ZU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIHZhciBnZXRNYXJrZXJOdW1iZXIgPSBmdW5jdGlvbihpZHgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU0FSRGV0ZWN0b3IuZ2V0SWRNYXJrZXJEYXRhKGlkeCk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnBhY2tldExlbmd0aCA+IDQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciByZXN1bHQ9MDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnBhY2tldExlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gKHJlc3VsdCA8PCA4KSB8IGRhdGEuZ2V0UGFja2V0RGF0YShpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBnZXRUcmFuc2Zvcm1NYXRyaXggPSBmdW5jdGlvbihpZHgpIHtcclxuICAgICAgICAgICAgdmFyIG1hdCA9IG5ldyBOeUFSVHJhbnNNYXRSZXN1bHQoKTtcclxuICAgICAgICAgICAgSlNBUkRldGVjdG9yLmdldFRyYW5zZm9ybU1hdHJpeChpZHgsIG1hdCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY20gPSBuZXcgRmxvYXQzMkFycmF5KDE2KTtcclxuICAgICAgICAgICAgY21bMF0gPSBtYXQubTAwO1xyXG4gICAgICAgICAgICBjbVsxXSA9IC1tYXQubTEwO1xyXG4gICAgICAgICAgICBjbVsyXSA9IG1hdC5tMjA7XHJcbiAgICAgICAgICAgIGNtWzNdID0gMDtcclxuICAgICAgICAgICAgY21bNF0gPSBtYXQubTAxO1xyXG4gICAgICAgICAgICBjbVs1XSA9IC1tYXQubTExO1xyXG4gICAgICAgICAgICBjbVs2XSA9IG1hdC5tMjE7XHJcbiAgICAgICAgICAgIGNtWzddID0gMDtcclxuICAgICAgICAgICAgY21bOF0gPSAtbWF0Lm0wMjtcclxuICAgICAgICAgICAgY21bOV0gPSBtYXQubTEyO1xyXG4gICAgICAgICAgICBjbVsxMF0gPSAtbWF0Lm0yMjtcclxuICAgICAgICAgICAgY21bMTFdID0gMDtcclxuICAgICAgICAgICAgY21bMTJdID0gbWF0Lm0wMztcclxuICAgICAgICAgICAgY21bMTNdID0gLW1hdC5tMTM7XHJcbiAgICAgICAgICAgIGNtWzE0XSA9IG1hdC5tMjM7XHJcbiAgICAgICAgICAgIGNtWzE1XSA9IDE7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY207XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZ2V0Q2FtZXJhTWF0cml4ID0gZnVuY3Rpb24oek5lYXIsIHpGYXIpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDMyQXJyYXkoMTYpO1xyXG4gICAgICAgICAgICBKU0FSUGFyYW1ldGVycy5jb3B5Q2FtZXJhTWF0cml4KHJlc3VsdCwgek5lYXIsIHpGYXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHBlcnNpc3RUaW1lID0gMTtcclxuICAgICAgICB2YXIgbmV3TWFya2VyID0gZnVuY3Rpb24oaWQsIG1hdHJpeCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgbWF0cml4OiBtYXRyaXgsXHJcbiAgICAgICAgICAgICAgICBhZ2U6IHBlcnNpc3RUaW1lLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWFya2VycyA9IHt9O1xyXG4gICAgICAgIHZhciBkZXRlY3QgPSBmdW5jdGlvbiggb25DcmVhdGUsIG9uVXBkYXRlLCBvbkRlc3Ryb3kgKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXJrZXJDb3VudCA9IEpTQVJEZXRlY3Rvci5kZXRlY3RNYXJrZXJMaXRlKEpTQVJSYXN0ZXIsIDcwKTsgXHJcbiAgICAgICAgICAgIGZvciggdmFyIGluZGV4ID0gMDsgaW5kZXggPCBtYXJrZXJDb3VudDsgaW5kZXgrKyApIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZCA9IGdldE1hcmtlck51bWJlcihpbmRleCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbWFya2Vyc1tpZF07XHJcbiAgICAgICAgICAgICAgICBpZiggbWFya2VyID09PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gbmV3TWFya2VyKGlkLCBnZXRUcmFuc2Zvcm1NYXRyaXgoaW5kZXgpKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzW2lkXSA9IG1hcmtlcjtcclxuICAgICAgICAgICAgICAgICAgICBvbkNyZWF0ZSggbWFya2VyICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXIubWF0cml4ID0gZ2V0VHJhbnNmb3JtTWF0cml4KGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYWdlID0gcGVyc2lzdFRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoIG1hcmtlciApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IoIHZhciBpZCBpbiBtYXJrZXJzICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbaWRdO1xyXG4gICAgICAgICAgICAgICAgaWYoIG1hcmtlciApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiggbWFya2VyLmFnZS0tID09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRGVzdHJveSggbWFya2VyICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtYXJrZXJzW2lkXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICBkZXRlY3Q6IGRldGVjdCxcclxuICAgICAgICAgICAgZ2V0Q2FtZXJhTWF0cml4OiBnZXRDYW1lcmFNYXRyaXhcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY3JlYXRlOmNyZWF0ZVxyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSJywgZnVuY3Rpb24oQVJDYW1lcmEsIEFSRGV0ZWN0b3IsIEFSM0QsIEFSTWFya2VyKSB7XHJcblxyXG4gICAgdmFyIGNhbnZhcywgY29udGV4dCwgZGV0ZWN0b3IsIHZpZXc7XHJcbiAgICB2YXIgaW5pdD1mdW5jdGlvbihnbENhbnZhcyl7XHJcblxyXG4gICAgICAgIGNhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIHZhciBjYW1lcmFEaW1lbnNpb25zPUFSQ2FtZXJhLmdldERpbWVuc2lvbnMoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhjYW1lcmFEaW1lbnNpb25zKVxyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbWVyYURpbWVuc2lvbnMud2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbWVyYURpbWVuc2lvbnMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBjb250ZXh0PWNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG4gICAgICAgIGRldGVjdG9yPUFSRGV0ZWN0b3IuY3JlYXRlKGNhbnZhcyk7XHJcblxyXG4gICAgICAgIHZpZXc9QVIzRC5jcmVhdGUoZ2xDYW52YXMsIGNhbWVyYURpbWVuc2lvbnMsIGNhbnZhcyk7XHJcblxyXG4gICAgICAgIHZpZXcuc2V0Q2FtZXJhTWF0cml4KCBkZXRlY3Rvci5nZXRDYW1lcmFNYXRyaXgoMTAsMTAwMCkgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRpY2s9ZnVuY3Rpb24oKXtcclxuICAgICAgICBBUkNhbWVyYS5jb3B5VG9Db250ZXh0KGNvbnRleHQpO1xyXG4gICAgICAgIGNhbnZhcy5jaGFuZ2VkPXRydWU7XHJcblxyXG4gICAgICAgIGRldGVjdG9yLmRldGVjdChBUk1hcmtlci5vbkNyZWF0ZSh2aWV3KSwgQVJNYXJrZXIub25VcGRhdGUodmlldyksIEFSTWFya2VyLm9uRGVzdHJveSh2aWV3KSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmlldy51cGRhdGUoKTtcclxuICAgICAgICB2aWV3LnJlbmRlcigpO1xyXG5cclxuXHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXQ6aW5pdCxcclxuICAgICAgICB0aWNrOnRpY2tcclxuICAgIH1cclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUk1hcmtlcicsIGZ1bmN0aW9uKEFST2JqZWN0KSB7XHJcblxyXG4gICAgdmFyIG9iamVjdHM9e1xyXG4gICAgICAgIDE2OiBBUk9iamVjdC5jcmVhdGUoe2NvbG9yOjB4Q0MwMDAwfSksXHJcbiAgICAgICAgMzI6IEFST2JqZWN0LmNyZWF0ZSh7Y29sb3I6MHgwMENDMDB9KSxcclxuICAgICAgICA2NDogQVJPYmplY3QuY3JlYXRlKHtjb2xvcjoweDAwMDBDQ30pXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHZhciBvbkNyZWF0ZT1mdW5jdGlvbih2aWV3KXtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24obWFya2VyKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVhdGVkXCIpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1hcmtlci5pZClcclxuICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBvYmplY3Q9b2JqZWN0c1ttYXJrZXIuaWRdO1xyXG4gICAgICAgICAgICBvYmplY3QudHJhbnNmb3JtKG1hcmtlci5tYXRyaXgpO1xyXG4gICAgICAgICAgICB2aWV3LmFkZChvYmplY3QpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhciBvblVwZGF0ZT1mdW5jdGlvbih2aWV3KXtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24obWFya2VyKXtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVwiKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtYXJrZXIuaWQpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgb2JqZWN0PW9iamVjdHNbbWFya2VyLmlkXTtcclxuICAgICAgICAgICAgb2JqZWN0LnRyYW5zZm9ybShtYXJrZXIubWF0cml4KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG9uRGVzdHJveT1mdW5jdGlvbih2aWV3KXtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24obWFya2VyKXtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlbW92ZVwiKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtYXJrZXIuaWQpXHJcbiAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgb2JqZWN0PW9iamVjdHNbbWFya2VyLmlkXTtcclxuICAgICAgICAgICAgdmlldy5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG9uQ3JlYXRlOm9uQ3JlYXRlLFxyXG4gICAgICAgIG9uVXBkYXRlOm9uVXBkYXRlLFxyXG4gICAgICAgIG9uRGVzdHJveTpvbkRlc3Ryb3lcclxuICAgIH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FST2JqZWN0JywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW5lcigpIHtcclxuICAgICAgICB2YXIgbW9kZWwgPSBuZXcgVEhSRUUuT2JqZWN0M0QoKTtcclxuICAgICAgICBtb2RlbC5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIG1vZGVsO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1hcmtlck1lc2goY29sb3IpIHtcclxuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQ3ViZUdlb21ldHJ5KCAxMDAsMTAwLDEwMCApO1xyXG4gICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCgge2NvbG9yOmNvbG9yLCBzaWRlOlRIUkVFLkRvdWJsZVNpZGUgfSApO1xyXG5cclxuICAgICAgICB2YXIgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ZXJpYWwgKTsgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgbWVzaC5wb3NpdGlvbi56ID0gLTQwO1xyXG5cclxuICAgICAgICByZXR1cm4gbWVzaDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVNYXJrZXJPYmplY3QocGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIG1vZGVsQ29udGFpbmVyID0gY3JlYXRlQ29udGFpbmVyKCk7XHJcblxyXG4gICAgICAgIHZhciBtb2RlbE1lc2ggPSBjcmVhdGVNYXJrZXJNZXNoKHBhcmFtcy5jb2xvcik7XHJcbiAgICAgICAgbW9kZWxDb250YWluZXIuYWRkKCBtb2RlbE1lc2ggKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdHJhbnNmb3JtKG1hdHJpeCkge1xyXG4gICAgICAgICAgICBtb2RlbENvbnRhaW5lci50cmFuc2Zvcm1Gcm9tQXJyYXkoIG1hdHJpeCApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2Zvcm0sXHJcbiAgICAgICAgICAgIG1vZGVsOiBtb2RlbENvbnRhaW5lclxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjcmVhdGU6Y3JlYXRlTWFya2VyT2JqZWN0XHJcbiAgICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUlV0aWxzJywgZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0pIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNpemU6ZnVuY3Rpb24oZWxlbSl7XHJcbiAgICAgICAgICAgIGVsZW0ud2lkdGg9d2luZG93LmlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgIGVsZW0uaGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbS53aWR0aD13aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgICAgIGVsZW0uaGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuXHJcblRIUkVFLk1hdHJpeDQucHJvdG90eXBlLnNldEZyb21BcnJheSA9IGZ1bmN0aW9uKG0pIHtcclxuICAgIHJldHVybiB0aGlzLnNldChcclxuICAgICAgICBtWzBdLCBtWzRdLCBtWzhdLCBtWzEyXSxcclxuICAgICAgICBtWzFdLCBtWzVdLCBtWzldLCBtWzEzXSxcclxuICAgICAgICBtWzJdLCBtWzZdLCBtWzEwXSwgbVsxNF0sXHJcbiAgICAgICAgbVszXSwgbVs3XSwgbVsxMV0sIG1bMTVdXHJcbiAgICApO1xyXG59XHJcblxyXG5USFJFRS5PYmplY3QzRC5wcm90b3R5cGUudHJhbnNmb3JtRnJvbUFycmF5ID0gZnVuY3Rpb24obSkge1xyXG4gICAgdGhpcy5tYXRyaXguc2V0RnJvbUFycmF5KG0pO1xyXG4gICAgdGhpcy5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTtcclxufSJdfQ==
