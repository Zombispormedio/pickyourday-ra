var app=angular.module("ar-toolkit",["ionic"]);angular.module("ar-toolkit").run(["$ionicPlatform",function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),angular.module("ar-toolkit").directive("arView",["ARUtils","ARCamera","AR",function(e,t,n){return{restrict:"A",link:function(e,r,a){var o=r[0];t.wait(function(){n.init(o)})}}}]),angular.module("ar-toolkit").factory("AR3D",function(){var e=function(e){function t(){o.needsUpdate=!0}var n=new THREE.Camera,r=new THREE.Scene,a=new THREE.PlaneGeometry(2,2,0),o=new THREE.Texture(e),i=new THREE.MeshBasicMaterial({map:o,depthTest:!1,depthWrite:!1}),u=new THREE.Mesh(a,i);return r.add(u),{camera:n,scene:r,update:t}},t=function(){function e(e){n.add(e)}function t(e){n.remove(e)}var n=new THREE.Scene,r=new THREE.Camera;return{scen:n,camera:r,add:e,remove:t}},n=function(n,r,a){var o=new THREE.WebGLRenderer({canvas:n});o.setSize(r.width,r.height),o.autoClear=!1;new e(a),new t,new THREE.SpotLight(16777215);return{}};return{create:n}}),angular.module("ar-toolkit").factory("ARCamera",["ARUtils",function(e){var t=document.createElement("video");e.fullPage(t);var n=function(e,t,n){var r=void 0;return navigator.getUserMedia?r=navigator.getUserMedia(e,t,n):navigator.webkitGetUserMedia&&(r=navigator.webkitGetUserMedia(e,t,n)),r},r=function(e){return function(n){var r=window.URL||window.webkitURL;t.src=r.createObjectURL(n),t.play(),e()}},a=function(e){console.log("An error occured! "+e)},o=function(e){n({video:!0,audio:!1},r(e),a)},i=function(){return{width:t.width,height:t.height}},u=function(e){e.drawImage(t,0,0)};return{wait:o,copyToContext:u,getDimensions:i}}]),angular.module("ar-toolkit").factory("ARDetector",function(){function e(){return{}}return{create:e}}),angular.module("ar-toolkit").factory("AR",["ARCamera","ARDetector","AR3D",function(e,t,n){var r,a,o,i,u=function(u){r=document.createElement("canvas");var c=e.getDimensions();r.width=c.width,r.height=c.height,a=r.getContext("2d"),o=t.create(r),i=n.create(u,c,r)};return{init:u}}]),angular.module("ar-toolkit").factory("ARUtils",function(){return{fullPage:function(e){e.width=window.innerWidth,e.height=window.innerHeight}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbmZpZy9ib290LmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL2FyX3ZpZXdfZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfM2RfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX2NhbWVyYV9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfZGV0ZWN0b3JfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl91dGlsc19mYWN0b3J5LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkaW9uaWNQbGF0Zm9ybSIsInJlYWR5Iiwid2luZG93IiwiY29yZG92YSIsInBsdWdpbnMiLCJLZXlib2FyZCIsImhpZGVLZXlib2FyZEFjY2Vzc29yeUJhciIsImRpc2FibGVTY3JvbGwiLCJTdGF0dXNCYXIiLCJzdHlsZURlZmF1bHQiLCJkaXJlY3RpdmUiLCJBUlV0aWxzIiwiQVJDYW1lcmEiLCJBUiIsInJlc3RyaWN0IiwibGluayIsInNjb3BlIiwidEVsZW1lbnQiLCJhdHRycyIsImVsZW0iLCJ3YWl0IiwiaW5pdCIsImZhY3RvcnkiLCJSZWFsaXR5Iiwic291cmNlQ2FudmFzIiwidXBkYXRlIiwidGV4dHVyZSIsIm5lZWRzVXBkYXRlIiwiY2FtZXJhIiwiVEhSRUUiLCJDYW1lcmEiLCJzY2VuZSIsIlNjZW5lIiwiZ2VvbWV0cnkiLCJQbGFuZUdlb21ldHJ5IiwiVGV4dHVyZSIsIm1hdGVyaWFsIiwiTWVzaEJhc2ljTWF0ZXJpYWwiLCJtYXAiLCJkZXB0aFRlc3QiLCJkZXB0aFdyaXRlIiwibWVzaCIsIk1lc2giLCJhZGQiLCJvYmplY3QiLCJyZW1vdmUiLCJzY2VuIiwiY3JlYXRlIiwiZ2xDYW52YXMiLCJkaW1lbnNpb25zIiwicmVuZGVyZXIiLCJXZWJHTFJlbmRlcmVyIiwiY2FudmFzIiwic2V0U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiYXV0b0NsZWFyIiwiU3BvdExpZ2h0IiwidmlkZW8iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJmdWxsUGFnZSIsImdldE1lZGlhQ2FwdHVyZSIsInQiLCJvbnN1Y2Nlc3MiLCJvbmVycm9yIiwicmVzdWx0IiwidW5kZWZpbmVkIiwibmF2aWdhdG9yIiwiZ2V0VXNlck1lZGlhIiwid2Via2l0R2V0VXNlck1lZGlhIiwib25TdWNjZXNzIiwiY2IiLCJzdHJlYW0iLCJ2ZW5kb3JVUkwiLCJVUkwiLCJ3ZWJraXRVUkwiLCJzcmMiLCJjcmVhdGVPYmplY3RVUkwiLCJwbGF5Iiwib25FcnJvciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ3YWl0Q2FtZXJhIiwiY2FsbGJhY2siLCJhdWRpbyIsImdldERpbWVuc2lvbnMiLCJjb3B5VG9Db250ZXh0IiwiY29udGV4dCIsImRyYXdJbWFnZSIsIkFSRGV0ZWN0b3IiLCJBUjNEIiwiZGV0ZWN0b3IiLCJ2aWV3IiwiY2FtZXJhRGltZW5zaW9ucyIsImdldENvbnRleHQiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsY0FBQSxTQ0FBRCxTQUFBQyxPQUFBLGNBQ0FDLEtBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQSxXQUNBQyxPQUFBQyxTQUFBRCxPQUFBQyxRQUFBQyxRQUFBQyxXQUdBRixRQUFBQyxRQUFBQyxTQUFBQywwQkFBQSxHQUtBSCxRQUFBQyxRQUFBQyxTQUFBRSxlQUFBLElBRUFMLE9BQUFNLFdBQ0FBLFVBQUFDLG9CQ2RBWixRQUFBQyxPQUFBLGNBQ0FZLFVBQUEsVUFBQSxVQUFBLFdBQUEsS0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUVBLE9BQ0FDLFNBQUEsSUFDQUMsS0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFGLEVBQUEsRUFFQUwsR0FBQVEsS0FBQSxXQUNBUCxF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LGNBQ0F3QixRQUFBLFVBQUEsV0FFQSxPQUNBdUMsU0FBQSxTQUFBMUMsR0FDQUEsRUFBQW1DLE1BQUFwRCxPQUFBK0YsV0FDQTlFLEVBQUFvQyxPQUFBckQsT0FBQWdHIiwiZmlsZSI6InBpY2t5b3VyZGF5Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHA9YW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnLCBbJ2lvbmljJ10pXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4ucnVuKGZ1bmN0aW9uKCRpb25pY1BsYXRmb3JtKSB7XHJcbiAgJGlvbmljUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICBpZih3aW5kb3cuY29yZG92YSAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zLktleWJvYXJkKSB7XHJcbiAgICAgIC8vIEhpZGUgdGhlIGFjY2Vzc29yeSBiYXIgYnkgZGVmYXVsdCAocmVtb3ZlIHRoaXMgdG8gc2hvdyB0aGUgYWNjZXNzb3J5IGJhciBhYm92ZSB0aGUga2V5Ym9hcmRcclxuICAgICAgLy8gZm9yIGZvcm0gaW5wdXRzKVxyXG4gICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xyXG5cclxuICAgICAgLy8gRG9uJ3QgcmVtb3ZlIHRoaXMgbGluZSB1bmxlc3MgeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nLiBJdCBzdG9wcyB0aGUgdmlld3BvcnRcclxuICAgICAgLy8gZnJvbSBzbmFwcGluZyB3aGVuIHRleHQgaW5wdXRzIGFyZSBmb2N1c2VkLiBJb25pYyBoYW5kbGVzIHRoaXMgaW50ZXJuYWxseSBmb3JcclxuICAgICAgLy8gYSBtdWNoIG5pY2VyIGtleWJvYXJkIGV4cGVyaWVuY2UuXHJcbiAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5kaXNhYmxlU2Nyb2xsKHRydWUpO1xyXG4gICAgfVxyXG4gICAgaWYod2luZG93LlN0YXR1c0Jhcikge1xyXG4gICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgICBcclxuICAgIFxyXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5kaXJlY3RpdmUoJ2FyVmlldycsIGZ1bmN0aW9uKEFSVXRpbHMsIEFSQ2FtZXJhLCBBUikge1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOmZ1bmN0aW9uKHNjb3BlLCB0RWxlbWVudCwgYXR0cnMpe1xyXG4gICAgICAgICAgICB2YXIgZWxlbT10RWxlbWVudFswXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIEFSQ2FtZXJhLndhaXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIEFSLmluaXQoZWxlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUjNEJywgZnVuY3Rpb24oKSB7XHJcblxyXG5cclxuICAgIHZhciBSZWFsaXR5PWZ1bmN0aW9uKHNvdXJjZUNhbnZhcyl7XHJcblxyXG4gICAgICAgIHZhciBjYW1lcmE9IG5ldyBUSFJFRS5DYW1lcmEoKTtcclxuICAgICAgICB2YXIgc2NlbmU9IG5ldyBUSFJFRS5TY2VuZSgpO1xyXG5cclxuICAgICAgICB2YXIgZ2VvbWV0cnk9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDIsMiwwKTtcclxuICAgICAgICB2YXIgdGV4dHVyZT1uZXcgVEhSRUUuVGV4dHVyZShzb3VyY2VDYW52YXMpO1xyXG4gICAgICAgIHZhciBtYXRlcmlhbD0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcclxuICAgICAgICAgICAgbWFwOnRleHR1cmUsXHJcbiAgICAgICAgICAgIGRlcHRoVGVzdDpmYWxzZSxcclxuICAgICAgICAgICAgZGVwdGhXcml0ZTpmYWxzZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgbWVzaD0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcclxuICAgICAgICBzY2VuZS5hZGQobWVzaCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZSgpe1xyXG4gICAgICAgICAgICB0ZXh0dXJlLm5lZWRzVXBkYXRlPXRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjYW1lcmE6IGNhbWVyYSxcclxuICAgICAgICAgICAgc2NlbmU6IHNjZW5lLFxyXG4gICAgICAgICAgICB1cGRhdGU6IHVwZGF0ZSwgXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgU2NlbmU9ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2NlbmU9bmV3IFRIUkVFLlNjZW5lKCk7XHJcbiAgICAgICAgdmFyIGNhbWVyYT1uZXcgVEhSRUUuQ2FtZXJhKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFkZChvYmplY3Qpe1xyXG4gICAgICAgICAgICBzY2VuZS5hZGQob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZShvYmplY3Qpe1xyXG4gICAgICAgICAgICBzY2VuZS5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybntcclxuICAgICAgICAgICAgc2NlbjpzY2VuZSxcclxuICAgICAgICAgICAgY2FtZXJhOmNhbWVyYSxcclxuICAgICAgICAgICAgYWRkOmFkZCxcclxuICAgICAgICAgICAgcmVtb3ZlOnJlbW92ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICB2YXIgY3JlYXRlPWZ1bmN0aW9uKGdsQ2FudmFzLCBkaW1lbnNpb25zLCBzb3VyY2VDYW52YXMpe1xyXG5cclxuICAgICAgICB2YXIgcmVuZGVyZXI9bmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoe2NhbnZhczpnbENhbnZhc30pO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFNpemUoZGltZW5zaW9ucy53aWR0aCwgZGltZW5zaW9ucy5oZWlnaHQpO1xyXG4gICAgICAgIHJlbmRlcmVyLmF1dG9DbGVhcj1mYWxzZTtcclxuXHJcbiAgICAgICAgdmFyIHJlYWxpdHk9IG5ldyBSZWFsaXR5KHNvdXJjZUNhbnZhcyk7XHJcbiAgICAgICAgdmFyIHZpcnR1YWw9IG5ldyBTY2VuZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBsaWdodD1uZXcgVEhSRUUuU3BvdExpZ2h0KDB4ZmZmZmZmKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY3JlYXRlOmNyZWF0ZVxyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSQ2FtZXJhJywgZnVuY3Rpb24oIEFSVXRpbHMpIHtcclxuXHJcbiAgICB2YXIgdmlkZW89IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7XHJcbiAgICBBUlV0aWxzLmZ1bGxQYWdlKHZpZGVvKTtcclxuXHJcbiAgICB2YXIgZ2V0TWVkaWFDYXB0dXJlID0gZnVuY3Rpb24odCwgb25zdWNjZXNzLCBvbmVycm9yKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBpZiAobmF2aWdhdG9yLmdldFVzZXJNZWRpYSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHQsIG9uc3VjY2Vzcywgb25lcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEodCwgb25zdWNjZXNzLCBvbmVycm9yKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBvblN1Y2Nlc3M9ZnVuY3Rpb24oY2Ipe1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzdHJlYW0pe1xyXG4gICAgICAgICAgICB2YXIgdmVuZG9yVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMO1xyXG4gICAgICAgICAgICB2aWRlby5zcmMgPSB2ZW5kb3JVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7XHJcbiAgICAgICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgdmFyIG9uRXJyb3I9ZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkFuIGVycm9yIG9jY3VyZWQhIFwiICsgZXJyKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHdhaXRDYW1lcmE9ZnVuY3Rpb24oY2FsbGJhY2spe1xyXG5cclxuICAgICAgICBnZXRNZWRpYUNhcHR1cmUoe3ZpZGVvOiB0cnVlLGF1ZGlvOiBmYWxzZX0sIG9uU3VjY2VzcyhjYWxsYmFjayksIG9uRXJyb3IpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YXIgZ2V0RGltZW5zaW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOnZpZGVvLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6dmlkZW8uaGVpZ2h0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBjb3B5VG9Db250ZXh0PWZ1bmN0aW9uKGNvbnRleHQpe1xyXG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHZpZGVvLCAwLDApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgd2FpdDp3YWl0Q2FtZXJhLFxyXG4gICAgICAgIGNvcHlUb0NvbnRleHQ6Y29weVRvQ29udGV4dCxcclxuICAgICAgICBnZXREaW1lbnNpb25zOmdldERpbWVuc2lvbnNcclxuICAgIH1cclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhci10b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUkRldGVjdG9yJywgZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGNyZWF0ZSgpe1xyXG4gICAgICAgIHJldHVybiB7fTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjcmVhdGU6Y3JlYXRlXHJcbiAgICB9XHJcbiAgICBcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSJywgZnVuY3Rpb24oQVJDYW1lcmEsIEFSRGV0ZWN0b3IsIEFSM0QpIHtcclxuXHJcbiAgICB2YXIgY2FudmFzLCBjb250ZXh0LCBkZXRlY3RvciwgdmlldztcclxuICAgIHZhciBpbml0PWZ1bmN0aW9uKGdsQ2FudmFzKXtcclxuXHJcbiAgICAgICAgY2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgdmFyIGNhbWVyYURpbWVuc2lvbnM9QVJDYW1lcmEuZ2V0RGltZW5zaW9ucygpO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbWVyYURpbWVuc2lvbnMud2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbWVyYURpbWVuc2lvbnMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBjb250ZXh0PWNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZGV0ZWN0b3I9QVJEZXRlY3Rvci5jcmVhdGUoY2FudmFzKTtcclxuICAgICAgICBcclxuICAgICAgICB2aWV3PUFSM0QuY3JlYXRlKGdsQ2FudmFzLCBjYW1lcmFEaW1lbnNpb25zLCBjYW52YXMpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXQ6aW5pdFxyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FyLXRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSVXRpbHMnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGZ1bGxQYWdlOmZ1bmN0aW9uKGVsZW0pe1xyXG4gICAgICAgICAgICBlbGVtLndpZHRoPXdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgICAgICBlbGVtLmhlaWdodD13aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
