function saveLocal(e,t){localStorage[e]=JSON.stringify(t)}function getJSONLocal(e){var t=null;try{var r=localStorage[e];void 0!==r&&(t=JSON.parse(r))}catch(o){}return t}function deleteLocal(e){localStorage.removeItem(e)}function ClosureMessage(e){return function(t){return function(){t(e)}}}function emptyOrUndefined(e){return void 0==e||""===e}function RandPosition(e){var t=e||{min:0,max:100},r=chance.floating(t),o=chance.floating(t),n=chance.floating(t);return[r,o,n]}function RandColor(e){var t=e||{min:0,max:1,fixed:2},r=chance.floating(t),o=chance.floating(t),n=chance.floating(t);return[r,o,n,1]}function RandSize(e){var t=e||{min:.1,max:2,fixed:1},r=chance.floating(t);return[r,r,r]}function RandRotation(e){var t=Number(chance.bool()),r=Number(chance.bool()),o=Number(chance.bool());return{angle:chance.integer({min:0,max:360}),axis:[t,r,o]}}function generate(e){return function(){var t=chance.integer({min:0,max:100});return Array.apply(0,Array(t)).map(e)}}var app=angular.module("artoolkit",["ionic","ngResource"]);angular.module("artoolkit").run(["$ionicPlatform","$rootScope","$state",function(e,t,r){t.go=function(e,t){r.go(e,t)},e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),angular.module("artoolkit").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,t,r){e.state("login",{url:"/login",onEnter:["$rootScope",function(e){getJSONLocal("user")&&e.go("app.ar")}],templateUrl:"src/views/login/main.html",controller:"LoginCtrl"}).state("app",{url:"/",onEnter:["$rootScope",function(e){getJSONLocal("user")||e.go("login")}],templateUrl:"src/views/main.html",controller:"AppCtrl","abstract":!0}).state("app.ar",{url:"ar",onEnter:["$rootScope",function(e){getJSONLocal("user")||e.go("login")}],views:{content:{templateUrl:"src/views/ar/main.html",controller:"ARCtrl"}}}),t.otherwise("/login"),r.interceptors.push("AuthInterceptor")}]),angular.module("artoolkit").controller("AppCtrl",["$scope",function(e){}]),angular.module("artoolkit").controller("ARCtrl",["$scope","ARObject",function(e,t){var r=t.createIcosahedron();e.actions={onCreate:function(e,t){console.log("create"),e.add(r)},onUpdate:function(e,t){console.log("update")},onDestroy:function(e,t){console.log("remove"),e.remove(r)}}}]),angular.module("artoolkit").controller("LoginCtrl",["$rootScope","$scope","OauthService","RequestService",function(e,t,r,o){t.user={email:"",password:""},t.login=function(){async.waterfall([function(e){var r=emptyOrUndefined(t.user.email),o=emptyOrUndefined(t.user.password);r||o?r?e("Email Empty"):o&&e("Password Empty"):e()},function(e){r.login().Session(t.user,function(t){return t.error?e(t.error):void e(null,t.data)},o.ServerNotFound(e))},function(e,t){r.role().check({role:e.role},function(r){return r.error?t(r.error):void(1==r.data||0==r.data?t(null,e):o.NoRoleAuthorized(t)())},o.ServerNotFound(t))}],function(t,r){return t?alert(t):(saveLocal("user",r),void e.go("app.ar"))})}}]),angular.module("artoolkit").directive("arView",["ARUtils","ARCamera","AR","$ionicPlatform",function(e,t,r,o){return{restrict:"A",scope:{actions:"=actions"},link:function(n,a,i){var c=a[0];console.log(n.actions),o.ready(function(){e.size(c),e.setVideoSize(),t.wait(function(){r.init(c,n.actions),r.tick()})})}}}]),angular.module("artoolkit").factory("AR3D",function(){var e=function(e){function t(){a.needsUpdate=!0}var r=new THREE.Camera,o=new THREE.Scene,n=new THREE.PlaneGeometry(2,2,0),a=new THREE.Texture(e);a.generateMipmaps=!1,a.minFilter=THREE.NearestFilter,a.magFilter=THREE.NearestFilter,a.wrapS=a.wrapT=THREE.ClampToEdgeWrapping;var i=new THREE.MeshBasicMaterial({map:a,depthTest:!1,depthWrite:!1}),c=new THREE.Mesh(n,i);return o.add(c),{camera:r,scene:o,update:t}},t=function(){function e(e){r.add(e)}function t(e){r.remove(e)}var r=new THREE.Scene,o=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);return o.position.z=5,{scene:r,camera:o,add:e,remove:t}},r=function(r,o,n){function a(){l.render(s.scene,s.camera),l.render(d.scene,d.camera)}function i(){s.update()}function c(e){d.add(e)}function u(e){d.remove(e)}var l=new THREE.WebGLRenderer({canvas:r,antialias:!0});l.setSize(o.width,o.height),l.setPixelRatio(window.devicePixelRatio),l.autoClear=!1;var s=new e(n),d=new t,f=new THREE.SpotLight(16777215);return f.position.set(0,0,9e3),f.lookAt(new THREE.Vector3(0,0,0)),d.scene.add(f),{add:c,remove:u,update:i,render:a,glCanvas:r,virtual:d.scene}};return{create:r}}),angular.module("artoolkit").factory("ARCamera",["ARUtils","$ionicPlatform",function(e,t){var r=document.getElementById("video"),o=function(e,t,r){var o=void 0;return navigator.getUserMedia?o=navigator.getUserMedia(e,t,r):navigator.webkitGetUserMedia&&(o=navigator.webkitGetUserMedia(e,t,r)),o},n=function(e){return function(t){var o=window.URL||window.webkitURL;r.src=o.createObjectURL(t),r.play(),e()}},a=function(e){console.log("An error occured! "+e)},i=function(e){o({video:!0,audio:!1},n(e),a)},c=function(){return{width:r.width,height:r.height}},u=function(e){e.drawImage(r,0,0)};return{wait:i,copyToContext:u,getDimensions:c}}]),angular.module("artoolkit").factory("ARDetector",function(){function e(e){var t=new NyARRgbRaster_Canvas2D(e),r=new FLARParam(e.width,e.height),o=new FLARMultiIdMarkerDetector(r,120);o.setContinueMode(!0);var n=function(e){var t=o.getIdMarkerData(e);if(t.packetLength>4)return-1;for(var r=0,n=0;n<t.packetLength;n++)r=r<<8|t.getPacketData(n);return r},a=function(e){var t=new NyARTransMatResult;o.getTransformMatrix(e,t);var r=new Float32Array(16);return r[0]=t.m00,r[1]=-t.m10,r[2]=t.m20,r[3]=0,r[4]=t.m01,r[5]=-t.m11,r[6]=t.m21,r[7]=0,r[8]=-t.m02,r[9]=t.m12,r[10]=-t.m22,r[11]=0,r[12]=t.m03,r[13]=-t.m13,r[14]=t.m23,r[15]=1,r},i=function(e,t){var o=new Float32Array(16);return r.copyCameraMatrix(o,e,t),o},c=1,u=function(e,t){return{id:e,matrix:t,age:c}},l={},s=function(e,r,i){for(var s=o.detectMarkerLite(t,70),d=0;s>d;d++){var f=n(d),g=l[f];void 0===g?(g=u(f,a(d)),l[f]=g,e(g)):(g.matrix=a(d),g.age=c,r(g))}for(var f in l){var g=l[f];g&&0==g.age--&&(i(g),delete l[f])}};return{detect:s,getCameraMatrix:i}}return{create:e}}),angular.module("artoolkit").factory("AR",["ARCamera","ARDetector","AR3D","ARMarker",function(e,t,r,o){var n,a,i,c,u,l=function(l,s){s=s||{},u={},n=document.createElement("canvas");var d=e.getDimensions();n.width=d.width,n.height=d.height,a=n.getContext("2d"),i=t.create(n),c=r.create(l,d,n),u.onCreate=o.Primitive(c,s.onCreate||o.onCreate),u.onUpdate=o.Primitive(c,s.onUpdate||o.onUpdate),u.onDestroy=o.Primitive(c,s.onDestroy||o.onDestroy)},s=function(){e.copyToContext(a),n.changed=!0,i.detect(u.onCreate,u.onUpdate,u.onDestroy),c.update(),c.render(),window.requestAnimationFrame(s)};return{init:l,tick:s}}]),angular.module("artoolkit").factory("ARMarker",["ARObject",function(e){var t={16:e.createBasicCube({color:13369344}),32:e.createBasicCube({color:52224}),64:e.createBasicCube({color:204})},r=function(e,r){console.log("Created"),console.log(r.id);var o=t[r.id];o.rotation.x+=.1,o.rotation.y+=.1,e.add(o)},o=function(e,r){console.log("update"),console.log(r.id);var o=t[r.id];o.rotation.x+=.1,o.rotation.y+=.1},n=function(e,r){console.log("remove"),console.log(r.id);var o=t[r.id];e.remove(o)},a=function(e,t){return console.log(t),function(r){t(e,r)}};return{Primitive:a,onCreate:r,onUpdate:o,onDestroy:n}}]),angular.module("artoolkit").factory("ARObject",function(){return{createBasicCube:function(e){var t=new THREE.BoxGeometry(1,1,1),r=new THREE.MeshBasicMaterial({color:e}),o=new THREE.Mesh(t,r);return o.position.z=-5,o},createPhongCube:function(){var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshPhongMaterial({color:8375321,shininess:230}),r=new THREE.Mesh(e,t);return r},createGradientPlane:function(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);r.addColorStop(.1,"rgba(210,210,210,1)"),r.addColorStop(1,"rgba(255,255,255,1)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height);var o=new THREE.Texture(e);o.needsUpdate=!0;var n=new THREE.MeshBasicMaterial({map:o}),a=new THREE.PlaneBufferGeometry(300,300,1,1),i=new THREE.Mesh(a,n);return i},createIcosahedron:function(){for(var e,t,r,o,n=1,a=["a","b","c"],i=new THREE.IcosahedronGeometry(n,1),c=0;c<i.faces.length;c++){t=i.faces[c];for(var u=0;3>u;u++)o=t[a[u]],r=i.vertices[o],e=new THREE.Color(16777215),e.setHSL((r.y/n+1)/2,1,.5),t.vertexColors[u]=e}var l=[new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,vertexColors:THREE.VertexColors,shininess:0}),new THREE.MeshBasicMaterial({color:0,shading:THREE.FlatShading,wireframe:!0,transparent:!0})];return THREE.SceneUtils.createMultiMaterialObject(i,l)}}}),angular.module("artoolkit").factory("ARUtils",["$ionicPlatform",function(e){var t=function(e){e.width=window.innerWidth,e.height=window.innerHeight};return{size:t,setVideoSize:function(){t(document.getElementById("video"))}}}]),angular.module("artoolkit").factory("ApiService",["$resource","$location",function(e,t){return{env:"prod",prod:{protocol:"https",host:"pickyourday.herokuapp.com",port:"",root:"api"},dev:{protocol:"http",host:"localhost",port:"5000",root:"api"},getApiPath:function(e){var t=this[this.env];return t.protocol+"://"+t.host+(""!==t.port?":"+t.port:"")+"/"+t.root+"/"+e},rest:function(t,r,o){var n=e(this.getApiPath(t),o||{},r||{});return n}}}]),angular.module("artoolkit").factory("AuthInterceptor",["$q","$location",function(e,t){return{request:function(e){e.headers=e.headers||{};var t=getJSONLocal("user"),t=getJSONLocal("user");return!e.headers.Authorization&&t&&(e.headers.Authorization=t.token),e},requestError:function(t){return e.reject(t)},response:function(t){return"ERROR"===t.data.status?e.reject(t):t||e.when(t)},responseError:function(r){return 403===r.status?(console.error("Error de acceso"),localStorage.user="",void t.path("/")):e.reject(r)}}}]),angular.module("artoolkit").factory("OauthService",["ApiService",function(e){return{base:"oauth",login:function(){return e.rest(this.base,{Session:{method:"POST",params:{}}})},logout:function(){return e.rest(this.base+"/logout",{Session:{method:"GET",params:{}}})},role:function(){return e.rest(this.base+"/role/:role",{check:{method:"GET",params:{role:"@role"}}})}}}]),angular.module("artoolkit").factory("RequestService",function(){return{ServerNotFound:ClosureMessage("Server Not Found"),NoRoleAuthorized:ClosureMessage("No Role Authorized")}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdXRpbHMuanMiLCJhcHAuanMiLCJjb25maWcvYm9vdC5qcyIsImNvbmZpZy9lbnZpcm9ubWVudC5qcyIsImNvbnRyb2xsZXJzL2FwcF9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvYXJfY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL2xvZ2luX2NvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvYXJfdmlld19kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl8zZF9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfY2FtZXJhX2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl9kZXRlY3Rvcl9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX21hcmtlcl9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfb2JqZWN0X2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl91dGlsc19mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9zZXJ2aWNlcy9hcGkuc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvaW50ZXJjZXB0b3Jfc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvb2F1dGguc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvcmVxdWVzdF9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbInNhdmVMb2NhbCIsImtleSIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SlNPTkxvY2FsIiwicmVzdWx0Iiwic3RyX2pzb24iLCJ1bmRlZmluZWQiLCJwYXJzZSIsImUiLCJkZWxldGVMb2NhbCIsInJlbW92ZUl0ZW0iLCJDbG9zdXJlTWVzc2FnZSIsIm1lc3NhZ2UiLCJmbiIsImVtcHR5T3JVbmRlZmluZWQiLCJ2YWx1ZSIsIlJhbmRQb3NpdGlvbiIsInYiLCJyYW5nZSIsIm1pbiIsIm1heCIsIngiLCJjaGFuY2UiLCJmbG9hdGluZyIsInkiLCJ6IiwiUmFuZENvbG9yIiwicmFuZ2VDb2xvciIsImZpeGVkIiwiciIsImciLCJiIiwiUmFuZFNpemUiLCJzaXplIiwiUmFuZFJvdGF0aW9uIiwiTnVtYmVyIiwiYm9vbCIsImFuZ2xlIiwiaW50ZWdlciIsImF4aXMiLCJnZW5lcmF0ZSIsImNvdW50IiwiQXJyYXkiLCJhcHBseSIsIm1hcCIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkaW9uaWNQbGF0Zm9ybSIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJnbyIsInN0YXRlIiwicGFyYW1zIiwicmVhZHkiLCJ3aW5kb3ciLCJjb3Jkb3ZhIiwicGx1Z2lucyIsIktleWJvYXJkIiwiaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyIiwiZGlzYWJsZVNjcm9sbCIsIlN0YXR1c0JhciIsInN0eWxlRGVmYXVsdCIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsInVybCIsIm9uRW50ZXIiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJhYnN0cmFjdCIsInZpZXdzIiwiY29udGVudCIsIm90aGVyd2lzZSIsImludGVyY2VwdG9ycyIsInB1c2giLCIkc2NvcGUiLCJBUk9iamVjdCIsIm9iamVjdCIsImNyZWF0ZUljb3NhaGVkcm9uIiwiYWN0aW9ucyIsIm9uQ3JlYXRlIiwidmlldyIsIm1hcmtlciIsImNvbnNvbGUiLCJsb2ciLCJhZGQiLCJvblVwZGF0ZSIsIm9uRGVzdHJveSIsInJlbW92ZSIsIk9hdXRoU2VydmljZSIsIlJlcXVlc3RTZXJ2aWNlIiwidXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCJsb2dpbiIsImFzeW5jIiwid2F0ZXJmYWxsIiwibmV4dCIsImlzRW1haWwiLCJpc1Bhc3N3b3JkIiwiU2Vzc2lvbiIsInJlcyIsImVycm9yIiwiU2VydmVyTm90Rm91bmQiLCJyb2xlIiwiY2hlY2siLCJOb1JvbGVBdXRob3JpemVkIiwiZXJyIiwiYWxlcnQiLCJkaXJlY3RpdmUiLCJBUlV0aWxzIiwiQVJDYW1lcmEiLCJBUiIsInJlc3RyaWN0Iiwic2NvcGUiLCJsaW5rIiwidEVsZW1lbnQiLCJhdHRycyIsImVsZW0iLCJzZXRWaWRlb1NpemUiLCJ3YWl0IiwiaW5pdCIsInRpY2siLCJmYWN0b3J5IiwiUmVhbGl0eSIsInNvdXJjZUNhbnZhcyIsInVwZGF0ZSIsInRleHR1cmUiLCJuZWVkc1VwZGF0ZSIsImNhbWVyYSIsIlRIUkVFIiwiQ2FtZXJhIiwic2NlbmUiLCJTY2VuZSIsImdlb21ldHJ5IiwiUGxhbmVHZW9tZXRyeSIsIlRleHR1cmUiLCJnZW5lcmF0ZU1pcG1hcHMiLCJtaW5GaWx0ZXIiLCJOZWFyZXN0RmlsdGVyIiwibWFnRmlsdGVyIiwid3JhcFMiLCJ3cmFwVCIsIkNsYW1wVG9FZGdlV3JhcHBpbmciLCJtYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiZGVwdGhUZXN0IiwiZGVwdGhXcml0ZSIsIm1lc2giLCJNZXNoIiwiUGVyc3BlY3RpdmVDYW1lcmEiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwb3NpdGlvbiIsImNyZWF0ZSIsImdsQ2FudmFzIiwiZGltZW5zaW9ucyIsInJlbmRlciIsInJlbmRlcmVyIiwicmVhbGl0eSIsInZpcnR1YWwiLCJXZWJHTFJlbmRlcmVyIiwiY2FudmFzIiwiYW50aWFsaWFzIiwic2V0U2l6ZSIsIndpZHRoIiwiaGVpZ2h0Iiwic2V0UGl4ZWxSYXRpbyIsImRldmljZVBpeGVsUmF0aW8iLCJhdXRvQ2xlYXIiLCJsaWdodCIsIlNwb3RMaWdodCIsInNldCIsImxvb2tBdCIsIlZlY3RvcjMiLCJ2aWRlbyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRNZWRpYUNhcHR1cmUiLCJ0Iiwib25zdWNjZXNzIiwib25lcnJvciIsIm5hdmlnYXRvciIsImdldFVzZXJNZWRpYSIsIndlYmtpdEdldFVzZXJNZWRpYSIsIm9uU3VjY2VzcyIsImNiIiwic3RyZWFtIiwidmVuZG9yVVJMIiwiVVJMIiwid2Via2l0VVJMIiwic3JjIiwiY3JlYXRlT2JqZWN0VVJMIiwicGxheSIsIm9uRXJyb3IiLCJ3YWl0Q2FtZXJhIiwiY2FsbGJhY2siLCJhdWRpbyIsImdldERpbWVuc2lvbnMiLCJjb3B5VG9Db250ZXh0IiwiY29udGV4dCIsImRyYXdJbWFnZSIsIkpTQVJSYXN0ZXIiLCJOeUFSUmdiUmFzdGVyX0NhbnZhczJEIiwiSlNBUlBhcmFtZXRlcnMiLCJGTEFSUGFyYW0iLCJKU0FSRGV0ZWN0b3IiLCJGTEFSTXVsdGlJZE1hcmtlckRldGVjdG9yIiwic2V0Q29udGludWVNb2RlIiwiZ2V0TWFya2VyTnVtYmVyIiwiaWR4IiwiZ2V0SWRNYXJrZXJEYXRhIiwicGFja2V0TGVuZ3RoIiwiaSIsImdldFBhY2tldERhdGEiLCJnZXRUcmFuc2Zvcm1NYXRyaXgiLCJtYXQiLCJOeUFSVHJhbnNNYXRSZXN1bHQiLCJjbSIsIkZsb2F0MzJBcnJheSIsIm0wMCIsIm0xMCIsIm0yMCIsIm0wMSIsIm0xMSIsIm0yMSIsIm0wMiIsIm0xMiIsIm0yMiIsIm0wMyIsIm0xMyIsIm0yMyIsImdldENhbWVyYU1hdHJpeCIsInpOZWFyIiwiekZhciIsImNvcHlDYW1lcmFNYXRyaXgiLCJwZXJzaXN0VGltZSIsIm5ld01hcmtlciIsImlkIiwibWF0cml4IiwiYWdlIiwibWFya2VycyIsImRldGVjdCIsIm1hcmtlckNvdW50IiwiZGV0ZWN0TWFya2VyTGl0ZSIsImluZGV4IiwiQVJEZXRlY3RvciIsIkFSM0QiLCJBUk1hcmtlciIsImRldGVjdG9yIiwibWFya2VyX2FjdGlvbnMiLCJjcmVhdGVFbGVtZW50IiwiY2FtZXJhRGltZW5zaW9ucyIsImdldENvbnRleHQiLCJQcmltaXRpdmUiLCJjaGFuZ2VkIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib2JqZWN0cyIsMTYsImNyZWF0ZUJhc2ljQ3ViZSIsImNvbG9yIiwzMiw2NCwicm90YXRpb24iLCJCb3hHZW9tZXRyeSIsImN1YmUiLCJjcmVhdGVQaG9uZ0N1YmUiLCJNZXNoUGhvbmdNYXRlcmlhbCIsInNoaW5pbmVzcyIsImNyZWF0ZUdyYWRpZW50UGxhbmUiLCJncmFkaWVudCIsImNyZWF0ZVJhZGlhbEdyYWRpZW50IiwiYWRkQ29sb3JTdG9wIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJzaGFkb3dUZXh0dXJlIiwic2hhZG93TWF0ZXJpYWwiLCJzaGFkb3dHZW8iLCJQbGFuZUJ1ZmZlckdlb21ldHJ5IiwiZiIsInAiLCJ2ZXJ0ZXhJbmRleCIsInJhZGl1cyIsImZhY2VJbmRpY2VzIiwiSWNvc2FoZWRyb25HZW9tZXRyeSIsImZhY2VzIiwibGVuZ3RoIiwiaiIsInZlcnRpY2VzIiwiQ29sb3IiLCJzZXRIU0wiLCJ2ZXJ0ZXhDb2xvcnMiLCJtYXRlcmlhbHMiLCJzaGFkaW5nIiwiRmxhdFNoYWRpbmciLCJWZXJ0ZXhDb2xvcnMiLCJ3aXJlZnJhbWUiLCJ0cmFuc3BhcmVudCIsIlNjZW5lVXRpbHMiLCJjcmVhdGVNdWx0aU1hdGVyaWFsT2JqZWN0IiwiJHJlc291cmNlIiwiJGxvY2F0aW9uIiwiZW52IiwicHJvZCIsInByb3RvY29sIiwiaG9zdCIsInBvcnQiLCJyb290IiwiZGV2IiwiZ2V0QXBpUGF0aCIsInBhdGgiLCJhcGkiLCJ0aGlzIiwicmVzdCIsIm1ldGhvZHMiLCJkZWZhdWx0UGFyYW1zIiwicmVzb3VyY2UiLCIkcSIsInJlcXVlc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInRva2VuIiwicmVxdWVzdEVycm9yIiwicmVqZWN0aW9uIiwicmVqZWN0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJ3aGVuIiwicmVzcG9uc2VFcnJvciIsIkFwaVNlcnZpY2UiLCJiYXNlIiwibWV0aG9kIiwibG9nb3V0Il0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxXQUFBQyxFQUFBQyxHQUNBQyxhQUFBRixHQUFBRyxLQUFBQyxVQUFBSCxHQUdBLFFBQUFJLGNBQUFMLEdB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QUFBLGlCQUFBLFdBRUEsT0FFQXBCLGVBQUEvRixlQUFBLG9CQUVBa0csaUJBQUFsRyxlQUFBIiwiZmlsZSI6InBpY2t5b3VyZGF5Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHNhdmVMb2NhbChrZXksIGRhdGEpIHtcclxuICAgIGxvY2FsU3RvcmFnZVtrZXldID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEpTT05Mb2NhbChrZXkpIHtcclxuXHJcbiAgICB2YXIgcmVzdWx0ID0gbnVsbDtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIHN0cl9qc29uID0gbG9jYWxTdG9yYWdlW2tleV07XHJcblxyXG4gICAgICAgIGlmIChzdHJfanNvbiE9PXVuZGVmaW5lZCkge1xyXG5cclxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShzdHJfanNvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlTG9jYWwoa2V5KSB7XHJcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBDbG9zdXJlTWVzc2FnZShtZXNzYWdlKXtcclxuICAgIHJldHVybiBmdW5jdGlvbihmbil7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGZuKG1lc3NhZ2UpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBlbXB0eU9yVW5kZWZpbmVkKHZhbHVlKXtcclxuICAgIHJldHVybiB2YWx1ZT09dm9pZCAwIHx8IHZhbHVlPT09XCJcIjtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIFJhbmRQb3NpdGlvbih2KSB7XHJcbiAgICB2YXIgcmFuZ2UgPSB2IHx8IHsgbWluOiAwLCBtYXg6IDEwMCB9O1xyXG4gICAgdmFyIHggPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2UpO1xyXG4gICAgdmFyIHkgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2UpO1xyXG4gICAgdmFyIHogPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2UpO1xyXG4gICAgcmV0dXJuIFt4LCB5LCB6XTtcclxufVxyXG5cclxuZnVuY3Rpb24gUmFuZENvbG9yKHYpIHtcclxuICAgIHZhciByYW5nZUNvbG9yID0gdiB8fCB7IG1pbjogMCwgbWF4OiAxLCBmaXhlZDogMiB9O1xyXG4gICAgdmFyIHIgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2VDb2xvcik7XHJcbiAgICB2YXIgZyA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZUNvbG9yKTtcclxuICAgIHZhciBiID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlQ29sb3IpO1xyXG4gICAgcmV0dXJuIFtyLCBnLCBiLCAxXTtcclxufVxyXG5cclxuZnVuY3Rpb24gUmFuZFNpemUodikge1xyXG4gICAgdmFyIHJhbmdlID0gdiB8fCB7IG1pbjogMC4xLCBtYXg6IDIsIGZpeGVkOiAxIH07XHJcbiAgICB2YXIgc2l6ZSA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZSk7XHJcbiAgICByZXR1cm4gW3NpemUsIHNpemUsIHNpemVdO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gUmFuZFJvdGF0aW9uKHYpe1xyXG4gICAgdmFyIHJhbmdlID0gdiB8fCB7IG1pbjogMCwgbWF4OiAzNjB9O1xyXG4gICAgdmFyIHg9TnVtYmVyKGNoYW5jZS5ib29sKCkpO1xyXG4gICAgdmFyIHk9TnVtYmVyKGNoYW5jZS5ib29sKCkpO1xyXG4gICAgdmFyIHo9TnVtYmVyKGNoYW5jZS5ib29sKCkpO1xyXG4gICAgcmV0dXJuICB7XHJcbiAgICAgICAgYW5nbGU6Y2hhbmNlLmludGVnZXIoeyBtaW46IDAsIG1heDogMzYwfSksXHJcbiAgICAgICAgYXhpczpbeCx5LHpdXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZShmbikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjb3VudCA9IGNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDEwMCB9KTtcclxuICAgICAgICByZXR1cm4gQXJyYXkuYXBwbHkoMCwgQXJyYXkoY291bnQpKS5tYXAoZm4pO1xyXG4gICAgfTtcclxufSIsInZhciBhcHA9YW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcsIFsnaW9uaWMnLCAnbmdSZXNvdXJjZSddKVxuXG5cbiAgICAgICAgICBcblx0XHQiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5ydW4oZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0sICRyb290U2NvcGUsICRzdGF0ZSkge1xyXG5cclxuICAgICRyb290U2NvcGUuZ28gPSBmdW5jdGlvbiAoc3RhdGUsIHBhcmFtcykge1xyXG4gICAgICAgICRzdGF0ZS5nbyhzdGF0ZSwgcGFyYW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICBpZih3aW5kb3cuY29yZG92YSAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zLktleWJvYXJkKSB7XHJcbiAgICAgICAgICAgIC8vIEhpZGUgdGhlIGFjY2Vzc29yeSBiYXIgYnkgZGVmYXVsdCAocmVtb3ZlIHRoaXMgdG8gc2hvdyB0aGUgYWNjZXNzb3J5IGJhciBhYm92ZSB0aGUga2V5Ym9hcmRcclxuICAgICAgICAgICAgLy8gZm9yIGZvcm0gaW5wdXRzKVxyXG4gICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xyXG5cclxuICAgICAgICAgICAgLy8gRG9uJ3QgcmVtb3ZlIHRoaXMgbGluZSB1bmxlc3MgeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nLiBJdCBzdG9wcyB0aGUgdmlld3BvcnRcclxuICAgICAgICAgICAgLy8gZnJvbSBzbmFwcGluZyB3aGVuIHRleHQgaW5wdXRzIGFyZSBmb2N1c2VkLiBJb25pYyBoYW5kbGVzIHRoaXMgaW50ZXJuYWxseSBmb3JcclxuICAgICAgICAgICAgLy8gYSBtdWNoIG5pY2VyIGtleWJvYXJkIGV4cGVyaWVuY2UuXHJcbiAgICAgICAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5kaXNhYmxlU2Nyb2xsKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih3aW5kb3cuU3RhdHVzQmFyKSB7XHJcbiAgICAgICAgICAgIFN0YXR1c0Jhci5zdHlsZURlZmF1bHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGh0dHBQcm92aWRlcil7XHJcbiAgICBcclxuICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgIC5zdGF0ZShcImxvZ2luXCIsIHtcclxuICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXHJcbiAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgaWYgKGdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwiYXBwLmFyXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3NyYy92aWV3cy9sb2dpbi9tYWluLmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnICAgICAgXHJcblxyXG4gICAgfSlcclxuICAgICAgICAuc3RhdGUoXCJhcHBcIiwge1xyXG4gICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmICghZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzcmMvdmlld3MvbWFpbi5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnQXBwQ3RybCcsXHJcbiAgICAgICAgYWJzdHJhY3Q6dHJ1ZVxyXG5cclxuICAgIH0pXHJcbiAgICAgICAgIC5zdGF0ZShcImFwcC5hclwiLCB7XHJcbiAgICAgICAgdXJsOiAnYXInLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmICghZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgY29udGVudDoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzcmMvdmlld3MvYXIvbWFpbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBUkN0cmwnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ICBcclxuICAgIH0pXHJcbiAgICBcclxuICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL2xvZ2luXCIpO1xyXG5cclxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpO1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5jb250cm9sbGVyKCdBcHBDdHJsJywgZnVuY3Rpb24oJHNjb3BlKSB7XHJcblxyXG5cclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0FSQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgQVJPYmplY3QpIHtcclxuXHJcblxyXG4gICAgdmFyIG9iamVjdD0gQVJPYmplY3QuY3JlYXRlSWNvc2FoZWRyb24oKTtcclxuXHJcblxyXG4gICAgJHNjb3BlLmFjdGlvbnM9e1xyXG5cclxuICAgICAgICBvbkNyZWF0ZTpmdW5jdGlvbih2aWV3LCBtYXJrZXIpe1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZVwiKVxyXG4gICAgICAgICAgICB2aWV3LmFkZChvYmplY3QpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25VcGRhdGU6ZnVuY3Rpb24odmlldywgbWFya2VyKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGVcIilcclxuXHJcblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25EZXN0cm95OmZ1bmN0aW9uKHZpZXcsIG1hcmtlcil7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVtb3ZlXCIpXHJcbiAgICAgICAgICAgIHZpZXcucmVtb3ZlKG9iamVjdCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcblxyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCBPYXV0aFNlcnZpY2UsIFJlcXVlc3RTZXJ2aWNlKXtcclxuICAgIFxyXG5cclxuICAgIFxyXG4gICAgJHNjb3BlLnVzZXIgPSB7ZW1haWw6XCJcIiwgcGFzc3dvcmQ6XCJcIn07XHJcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXN5bmMud2F0ZXJmYWxsKFtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZhbGlkYXRlKG5leHQpe1xyXG4gICAgICAgICAgICAgICAgdmFyIGlzRW1haWw9ZW1wdHlPclVuZGVmaW5lZCgkc2NvcGUudXNlci5lbWFpbCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNQYXNzd29yZD1lbXB0eU9yVW5kZWZpbmVkKCRzY29wZS51c2VyLnBhc3N3b3JkKTtcclxuICAgICAgICAgICAgICAgIGlmKGlzRW1haWwgfHwgaXNQYXNzd29yZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaXNFbWFpbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoXCJFbWFpbCBFbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXNQYXNzd29yZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoXCJQYXNzd29yZCBFbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gbG9naW4obmV4dCl7XHJcblxyXG4gICAgICAgICAgICAgICAgT2F1dGhTZXJ2aWNlLmxvZ2luKCkuU2Vzc2lvbigkc2NvcGUudXNlciwgZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZXJyb3IpcmV0dXJuIG5leHQocmVzLmVycm9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dChudWxsLCByZXMuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSwgUmVxdWVzdFNlcnZpY2UuU2VydmVyTm90Rm91bmQobmV4dCkpO1xyXG5cclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrUm9sZSh1c2VyLCBuZXh0KXtcclxuICAgICAgICAgICAgICAgIE9hdXRoU2VydmljZS5yb2xlKCkuY2hlY2soe3JvbGU6dXNlci5yb2xlfSwgZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZXJyb3IpcmV0dXJuIG5leHQocmVzLmVycm9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGE9PTF8fHJlcy5kYXRhPT0wKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQobnVsbCwgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFJlcXVlc3RTZXJ2aWNlLk5vUm9sZUF1dGhvcml6ZWQobmV4dCkoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSwgUmVxdWVzdFNlcnZpY2UuU2VydmVyTm90Rm91bmQobmV4dCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgXSwgZnVuY3Rpb24oZXJyLCB1c2VyKXtcclxuICAgICAgICAgICAgaWYoZXJyKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhbGVydChlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNhdmVMb2NhbChcInVzZXJcIiwgdXNlcik7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJhcHAuYXJcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgIH07XHJcblxyXG5cclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZGlyZWN0aXZlKCdhclZpZXcnLCBmdW5jdGlvbihBUlV0aWxzLCBBUkNhbWVyYSwgQVIsICRpb25pY1BsYXRmb3JtKSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICBzY29wZTp7XHJcbiAgICAgICAgICAgIGFjdGlvbnM6XCI9YWN0aW9uc1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBsaW5rOmZ1bmN0aW9uKHNjb3BlLCB0RWxlbWVudCwgYXR0cnMpe1xyXG4gICAgICAgICAgICB2YXIgZWxlbT10RWxlbWVudFswXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNjb3BlLmFjdGlvbnMpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIEFSVXRpbHMuc2l6ZShlbGVtKTtcclxuICAgICAgICAgICAgICAgIEFSVXRpbHMuIHNldFZpZGVvU2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgQVJDYW1lcmEud2FpdChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIEFSLmluaXQoZWxlbSwgc2NvcGUuYWN0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgQVIudGljaygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSM0QnLCBmdW5jdGlvbigpIHtcclxuXHJcblxyXG4gICAgdmFyIFJlYWxpdHk9ZnVuY3Rpb24oc291cmNlQ2FudmFzKXtcclxuXHJcbiAgICAgICAgdmFyIGNhbWVyYT0gbmV3IFRIUkVFLkNhbWVyYSgpO1xyXG4gICAgICAgIHZhciBzY2VuZT0gbmV3IFRIUkVFLlNjZW5lKCk7XHJcblxyXG4gICAgICAgIHZhciBnZW9tZXRyeT0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoMiwyLDApO1xyXG4gICAgICAgIHZhciB0ZXh0dXJlPW5ldyBUSFJFRS5UZXh0dXJlKHNvdXJjZUNhbnZhcyk7XHJcbiAgICAgICAgdGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMgPSBmYWxzZTtcclxuICAgICAgICB0ZXh0dXJlLm1pbkZpbHRlciA9IFRIUkVFLk5lYXJlc3RGaWx0ZXI7XHJcbiAgICAgICAgdGV4dHVyZS5tYWdGaWx0ZXIgPSBUSFJFRS5OZWFyZXN0RmlsdGVyO1xyXG4gICAgICAgIHRleHR1cmUud3JhcFMgPSB0ZXh0dXJlLndyYXBUID1USFJFRS5DbGFtcFRvRWRnZVdyYXBwaW5nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIG1hdGVyaWFsPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgICBtYXA6dGV4dHVyZSxcclxuICAgICAgICAgICAgZGVwdGhUZXN0OmZhbHNlLFxyXG4gICAgICAgICAgICBkZXB0aFdyaXRlOmZhbHNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBtZXNoPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIHNjZW5lLmFkZChtZXNoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlKCl7XHJcbiAgICAgICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGU9dHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNhbWVyYTogY2FtZXJhLFxyXG4gICAgICAgICAgICBzY2VuZTogc2NlbmUsXHJcbiAgICAgICAgICAgIHVwZGF0ZTogdXBkYXRlLCBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBTY2VuZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xyXG4gICAgICAgIHZhciBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDc1LCB3aW5kb3cuaW5uZXJXaWR0aC93aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMCApO1xyXG4gICAgICAgIFx0Y2FtZXJhLnBvc2l0aW9uLnogPSA1O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGQob2JqZWN0KSB7XHJcblxyXG4gICAgICAgICAgICBzY2VuZS5hZGQob2JqZWN0KTtcclxuXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKG9iamVjdCkge1xyXG4gICAgICAgICAgICBzY2VuZS5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNjZW5lOnNjZW5lLFxyXG4gICAgICAgICAgICBjYW1lcmE6Y2FtZXJhLFxyXG4gICAgICAgICAgICBhZGQ6YWRkLFxyXG4gICAgICAgICAgICByZW1vdmU6cmVtb3ZlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICB2YXIgY3JlYXRlPWZ1bmN0aW9uKGdsQ2FudmFzLCBkaW1lbnNpb25zLCBzb3VyY2VDYW52YXMpe1xyXG5cclxuICAgICAgICB2YXIgcmVuZGVyZXI9bmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoe2NhbnZhczpnbENhbnZhcywgYW50aWFsaWFzOiB0cnVlIH0pO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFNpemUoZGltZW5zaW9ucy53aWR0aCwgZGltZW5zaW9ucy5oZWlnaHQpO1xyXG4gICAgICAgIHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICk7XHJcbiAgICAgICAgcmVuZGVyZXIuYXV0b0NsZWFyPWZhbHNlO1xyXG5cclxuICAgICAgICB2YXIgcmVhbGl0eT0gbmV3IFJlYWxpdHkoc291cmNlQ2FudmFzKTtcclxuICAgICAgICB2YXIgdmlydHVhbD0gbmV3IFNjZW5lKCk7XHJcblxyXG4gICAgICAgIHZhciBsaWdodD1uZXcgVEhSRUUuU3BvdExpZ2h0KDB4ZmZmZmZmKTtcclxuICAgICAgICBsaWdodC5wb3NpdGlvbi5zZXQoMCwwLDkwMDApO1xyXG4gICAgICAgIGxpZ2h0Lmxvb2tBdChuZXcgVEhSRUUuVmVjdG9yMygwLDAsMCkpO1xyXG4gICAgICAgIHZpcnR1YWwuc2NlbmUuYWRkKGxpZ2h0KTtcclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoKXtcclxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyKHJlYWxpdHkuc2NlbmUsIHJlYWxpdHkuY2FtZXJhKTtcclxuXHJcbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbmRlcih2aXJ0dWFsLnNjZW5lLCB2aXJ0dWFsLmNhbWVyYSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlKCl7XHJcbiAgICAgICAgICAgICByZWFsaXR5LnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWRkKG9iamVjdCl7XHJcbiAgICAgICAgICAgICAgdmlydHVhbC5hZGQob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICBcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKG9iamVjdCl7XHJcbiAgICAgICAgICAgICB2aXJ0dWFsLnJlbW92ZShvYmplY3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWRkOiBhZGQsXHJcbiAgICAgICAgICAgIHJlbW92ZTogcmVtb3ZlLFxyXG4gICAgICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcclxuICAgICAgICAgICAgcmVuZGVyOiByZW5kZXIsXHJcbiAgICAgICAgICAgIGdsQ2FudmFzOiBnbENhbnZhcyxcclxuICAgICAgICAgICAgdmlydHVhbDp2aXJ0dWFsLnNjZW5lXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGNyZWF0ZTpjcmVhdGVcclxuICAgIH1cclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSQ2FtZXJhJywgZnVuY3Rpb24oIEFSVXRpbHMsICRpb25pY1BsYXRmb3JtKSB7XHJcblxyXG4gICAgdmFyIHZpZGVvPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlkZW8nKTtcclxuIFxyXG4gICAgdmFyIGdldE1lZGlhQ2FwdHVyZSA9IGZ1bmN0aW9uKHQsIG9uc3VjY2Vzcywgb25lcnJvcikge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKG5hdmlnYXRvci5nZXRVc2VyTWVkaWEpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSh0LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKHQsIG9uc3VjY2Vzcywgb25lcnJvcik7XHJcbiAgICAgICAgfSBcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgb25TdWNjZXNzPWZ1bmN0aW9uKGNiKXtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oc3RyZWFtKXtcclxuICAgICAgICAgICAgdmFyIHZlbmRvclVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDtcclxuICAgICAgICAgICAgdmlkZW8uc3JjID0gdmVuZG9yVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pO1xyXG4gICAgICAgICAgICB2aWRlby5wbGF5KCk7XHJcbiAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHZhciBvbkVycm9yPWZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJBbiBlcnJvciBvY2N1cmVkISBcIiArIGVycik7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHZhciB3YWl0Q2FtZXJhPWZ1bmN0aW9uKGNhbGxiYWNrKXtcclxuXHJcbiAgICAgICAgZ2V0TWVkaWFDYXB0dXJlKHt2aWRlbzogdHJ1ZSxhdWRpbzogZmFsc2V9LCBvblN1Y2Nlc3MoY2FsbGJhY2spLCBvbkVycm9yKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGdldERpbWVuc2lvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB3aWR0aDp2aWRlby53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OnZpZGVvLmhlaWdodFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgY29weVRvQ29udGV4dD1mdW5jdGlvbihjb250ZXh0KXtcclxuICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh2aWRlbywgMCwwKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHdhaXQ6d2FpdENhbWVyYSxcclxuICAgICAgICBjb3B5VG9Db250ZXh0OmNvcHlUb0NvbnRleHQsXHJcbiAgICAgICAgZ2V0RGltZW5zaW9uczpnZXREaW1lbnNpb25zXHJcbiAgICB9XHJcblxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUkRldGVjdG9yJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlKHNvdXJjZUNhbnZhcyl7XHJcbiAgICAgICB2YXIgSlNBUlJhc3RlciA9IG5ldyBOeUFSUmdiUmFzdGVyX0NhbnZhczJEKHNvdXJjZUNhbnZhcyk7XHJcbiAgICAgICAgdmFyIEpTQVJQYXJhbWV0ZXJzID0gbmV3IEZMQVJQYXJhbShzb3VyY2VDYW52YXMud2lkdGgsIHNvdXJjZUNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgIHZhciBKU0FSRGV0ZWN0b3IgPSBuZXcgRkxBUk11bHRpSWRNYXJrZXJEZXRlY3RvcihKU0FSUGFyYW1ldGVycywgMTIwKTtcclxuICAgICAgICBKU0FSRGV0ZWN0b3Iuc2V0Q29udGludWVNb2RlKHRydWUpO1xyXG5cclxuICAgICAgICB2YXIgZ2V0TWFya2VyTnVtYmVyID0gZnVuY3Rpb24oaWR4KSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gSlNBUkRldGVjdG9yLmdldElkTWFya2VyRGF0YShpZHgpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5wYWNrZXRMZW5ndGggPiA0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgcmVzdWx0PTA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5wYWNrZXRMZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCBkYXRhLmdldFBhY2tldERhdGEoaSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZ2V0VHJhbnNmb3JtTWF0cml4ID0gZnVuY3Rpb24oaWR4KSB7XHJcbiAgICAgICAgICAgIHZhciBtYXQgPSBuZXcgTnlBUlRyYW5zTWF0UmVzdWx0KCk7XHJcbiAgICAgICAgICAgIEpTQVJEZXRlY3Rvci5nZXRUcmFuc2Zvcm1NYXRyaXgoaWR4LCBtYXQpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNtID0gbmV3IEZsb2F0MzJBcnJheSgxNik7XHJcbiAgICAgICAgICAgIGNtWzBdID0gbWF0Lm0wMDtcclxuICAgICAgICAgICAgY21bMV0gPSAtbWF0Lm0xMDtcclxuICAgICAgICAgICAgY21bMl0gPSBtYXQubTIwO1xyXG4gICAgICAgICAgICBjbVszXSA9IDA7XHJcbiAgICAgICAgICAgIGNtWzRdID0gbWF0Lm0wMTtcclxuICAgICAgICAgICAgY21bNV0gPSAtbWF0Lm0xMTtcclxuICAgICAgICAgICAgY21bNl0gPSBtYXQubTIxO1xyXG4gICAgICAgICAgICBjbVs3XSA9IDA7XHJcbiAgICAgICAgICAgIGNtWzhdID0gLW1hdC5tMDI7XHJcbiAgICAgICAgICAgIGNtWzldID0gbWF0Lm0xMjtcclxuICAgICAgICAgICAgY21bMTBdID0gLW1hdC5tMjI7XHJcbiAgICAgICAgICAgIGNtWzExXSA9IDA7XHJcbiAgICAgICAgICAgIGNtWzEyXSA9IG1hdC5tMDM7XHJcbiAgICAgICAgICAgIGNtWzEzXSA9IC1tYXQubTEzO1xyXG4gICAgICAgICAgICBjbVsxNF0gPSBtYXQubTIzO1xyXG4gICAgICAgICAgICBjbVsxNV0gPSAxO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGdldENhbWVyYU1hdHJpeCA9IGZ1bmN0aW9uKHpOZWFyLCB6RmFyKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgRmxvYXQzMkFycmF5KDE2KTtcclxuICAgICAgICAgICAgSlNBUlBhcmFtZXRlcnMuY29weUNhbWVyYU1hdHJpeChyZXN1bHQsIHpOZWFyLCB6RmFyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBwZXJzaXN0VGltZSA9IDE7XHJcbiAgICAgICAgdmFyIG5ld01hcmtlciA9IGZ1bmN0aW9uKGlkLCBtYXRyaXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgIG1hdHJpeDogbWF0cml4LFxyXG4gICAgICAgICAgICAgICAgYWdlOiBwZXJzaXN0VGltZSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1hcmtlcnMgPSB7fTtcclxuICAgICAgICB2YXIgZGV0ZWN0ID0gZnVuY3Rpb24oIG9uQ3JlYXRlLCBvblVwZGF0ZSwgb25EZXN0cm95ICkge1xyXG4gICAgICAgICAgICB2YXIgbWFya2VyQ291bnQgPSBKU0FSRGV0ZWN0b3IuZGV0ZWN0TWFya2VyTGl0ZShKU0FSUmFzdGVyLCA3MCk7IFxyXG4gICAgICAgICAgICBmb3IoIHZhciBpbmRleCA9IDA7IGluZGV4IDwgbWFya2VyQ291bnQ7IGluZGV4KysgKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBnZXRNYXJrZXJOdW1iZXIoaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbaWRdO1xyXG4gICAgICAgICAgICAgICAgaWYoIG1hcmtlciA9PT0gdW5kZWZpbmVkICkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlciA9IG5ld01hcmtlcihpZCwgZ2V0VHJhbnNmb3JtTWF0cml4KGluZGV4KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc1tpZF0gPSBtYXJrZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgb25DcmVhdGUoIG1hcmtlciApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLm1hdHJpeCA9IGdldFRyYW5zZm9ybU1hdHJpeChpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLmFnZSA9IHBlcnNpc3RUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlKCBtYXJrZXIgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yKCB2YXIgaWQgaW4gbWFya2VycyApIHtcclxuICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSBtYXJrZXJzW2lkXTtcclxuICAgICAgICAgICAgICAgIGlmKCBtYXJrZXIgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIG1hcmtlci5hZ2UtLSA9PSAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkRlc3Ryb3koIG1hcmtlciApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgbWFya2Vyc1tpZF07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICBkZXRlY3Q6IGRldGVjdCxcclxuICAgICAgICAgICAgZ2V0Q2FtZXJhTWF0cml4OiBnZXRDYW1lcmFNYXRyaXhcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY3JlYXRlOmNyZWF0ZVxyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeSgnQVInLCBmdW5jdGlvbihBUkNhbWVyYSwgQVJEZXRlY3RvciwgQVIzRCwgQVJNYXJrZXIpIHtcclxuXHJcbiAgICB2YXIgY2FudmFzLCBjb250ZXh0LCBkZXRlY3RvciwgdmlldywgYWN0aW9ucztcclxuICAgIHZhciBpbml0PWZ1bmN0aW9uKGdsQ2FudmFzLCBtYXJrZXJfYWN0aW9ucyl7XHJcblxyXG4gICAgICAgIG1hcmtlcl9hY3Rpb25zPW1hcmtlcl9hY3Rpb25zIHx8e31cclxuICAgICAgICBhY3Rpb25zPXt9OyBcclxuXHJcbiAgICAgICAgY2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgdmFyIGNhbWVyYURpbWVuc2lvbnM9QVJDYW1lcmEuZ2V0RGltZW5zaW9ucygpO1xyXG5cclxuICAgICAgICBjYW52YXMud2lkdGggPSBjYW1lcmFEaW1lbnNpb25zLndpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW1lcmFEaW1lbnNpb25zLmhlaWdodDtcclxuXHJcbiAgICAgICAgY29udGV4dD1jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgICAgICBkZXRlY3Rvcj1BUkRldGVjdG9yLmNyZWF0ZShjYW52YXMpO1xyXG5cclxuICAgICAgICB2aWV3PUFSM0QuY3JlYXRlKGdsQ2FudmFzLCBjYW1lcmFEaW1lbnNpb25zLCBjYW52YXMpO1xyXG5cclxuICAgICAgICBhY3Rpb25zLm9uQ3JlYXRlPUFSTWFya2VyLlByaW1pdGl2ZSh2aWV3LCBtYXJrZXJfYWN0aW9ucy5vbkNyZWF0ZXx8QVJNYXJrZXIub25DcmVhdGUpO1xyXG4gICAgICAgIGFjdGlvbnMub25VcGRhdGU9QVJNYXJrZXIuUHJpbWl0aXZlKHZpZXcsIG1hcmtlcl9hY3Rpb25zLm9uVXBkYXRlfHxBUk1hcmtlci5vblVwZGF0ZSk7XHJcbiAgICAgICAgYWN0aW9ucy5vbkRlc3Ryb3k9QVJNYXJrZXIuUHJpbWl0aXZlKHZpZXcsIG1hcmtlcl9hY3Rpb25zLm9uRGVzdHJveXx8QVJNYXJrZXIub25EZXN0cm95KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRpY2s9ZnVuY3Rpb24oKXtcclxuICAgICAgICBBUkNhbWVyYS5jb3B5VG9Db250ZXh0KGNvbnRleHQpO1xyXG4gICAgICAgIGNhbnZhcy5jaGFuZ2VkPXRydWU7XHJcblxyXG4gICAgICAgIGRldGVjdG9yLmRldGVjdChhY3Rpb25zLm9uQ3JlYXRlLCBhY3Rpb25zLm9uVXBkYXRlLCBhY3Rpb25zLm9uRGVzdHJveSk7XHJcblxyXG4gICAgICAgIHZpZXcudXBkYXRlKCk7XHJcbiAgICAgICAgdmlldy5yZW5kZXIoKTtcclxuXHJcblxyXG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbml0OmluaXQsXHJcbiAgICAgICAgdGljazp0aWNrXHJcbiAgICB9XHJcblxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUk1hcmtlcicsIGZ1bmN0aW9uKEFST2JqZWN0KSB7XHJcblxyXG4gICAgdmFyIG9iamVjdHM9e1xyXG4gICAgICAgIDE2OiBBUk9iamVjdC5jcmVhdGVCYXNpY0N1YmUoe2NvbG9yOjB4Q0MwMDAwfSksXHJcbiAgICAgICAgMzI6IEFST2JqZWN0LmNyZWF0ZUJhc2ljQ3ViZSh7Y29sb3I6MHgwMENDMDB9KSxcclxuICAgICAgICA2NDogQVJPYmplY3QuY3JlYXRlQmFzaWNDdWJlKHtjb2xvcjoweDAwMDBDQ30pXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHZhciBvbkNyZWF0ZT1mdW5jdGlvbih2aWV3LCBtYXJrZXIpe1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcIkNyZWF0ZWRcIilcclxuICAgICAgICBjb25zb2xlLmxvZyhtYXJrZXIuaWQpXHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIG9iamVjdD1vYmplY3RzW21hcmtlci5pZF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgb2JqZWN0LnJvdGF0aW9uLnggKz0gMC4xO1xyXG4gICAgICAgIG9iamVjdC5yb3RhdGlvbi55ICs9IDAuMTtcclxuICAgICAgICBcclxuICAgICAgICB2aWV3LmFkZChvYmplY3QpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBvblVwZGF0ZT1mdW5jdGlvbih2aWV3LCBtYXJrZXIpe1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVwiKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKG1hcmtlci5pZClcclxuXHJcbiAgICAgICAgdmFyIG9iamVjdD1vYmplY3RzW21hcmtlci5pZF07XHJcblxyXG4gICAgICAgIG9iamVjdC5yb3RhdGlvbi54ICs9IDAuMTtcclxuICAgICAgICBvYmplY3Qucm90YXRpb24ueSArPSAwLjE7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhciBvbkRlc3Ryb3k9ZnVuY3Rpb24odmlldywgbWFya2VyKXtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJyZW1vdmVcIilcclxuICAgICAgICBjb25zb2xlLmxvZyhtYXJrZXIuaWQpXHJcblxyXG4gICAgICAgIHZhciBvYmplY3Q9b2JqZWN0c1ttYXJrZXIuaWRdO1xyXG4gICAgICAgIHZpZXcucmVtb3ZlKG9iamVjdCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhciBQcmltaXRpdmU9ZnVuY3Rpb24odmlldywgY2Ipe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNiKVxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihtYXJrZXIpe1xyXG4gICAgICAgICAgICBjYih2aWV3LCBtYXJrZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIFByaW1pdGl2ZTpQcmltaXRpdmUsXHJcbiAgICAgICAgb25DcmVhdGU6b25DcmVhdGUsXHJcbiAgICAgICAgb25VcGRhdGU6b25VcGRhdGUsXHJcbiAgICAgICAgb25EZXN0cm95Om9uRGVzdHJveVxyXG4gICAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAuZmFjdG9yeSgnQVJPYmplY3QnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG5cclxuICAgICAgY3JlYXRlQmFzaWNDdWJlOiBmdW5jdGlvbihjb2xvcikge1xyXG4gICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgxLCAxLCAxKTtcclxuICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IGNvbG9yXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGN1YmUgPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIGN1YmUucG9zaXRpb24ueiA9IC01O1xyXG4gICAgICAgIHJldHVybiBjdWJlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgY3JlYXRlUGhvbmdDdWJlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMSwgMSwgMSk7XHJcbiAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtcclxuICAgICAgICAgIGNvbG9yOiAweDdGQ0MxOSxcclxuICAgICAgICAgIHNoaW5pbmVzczogMjMwXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGN1YmUgPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIHJldHVybiBjdWJlO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgY3JlYXRlR3JhZGllbnRQbGFuZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgY2FudmFzLndpZHRoID0gMTI4O1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSAxMjg7XHJcblxyXG4gICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbiAgICAgICAgdmFyIGdyYWRpZW50ID0gY29udGV4dC5jcmVhdGVSYWRpYWxHcmFkaWVudChjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMiwgMCwgY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIsIGNhbnZhcy53aWR0aCAvIDIpO1xyXG5cclxuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMC4xLCAncmdiYSgyMTAsMjEwLDIxMCwxKScpO1xyXG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCAncmdiYSgyNTUsMjU1LDI1NSwxKScpO1xyXG5cclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGdyYWRpZW50O1xyXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuXHJcblxyXG4gICAgICAgIHZhciBzaGFkb3dUZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmUoY2FudmFzKTtcclxuICAgICAgICBzaGFkb3dUZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdmFyIHNoYWRvd01hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcclxuICAgICAgICAgIG1hcDogc2hhZG93VGV4dHVyZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBzaGFkb3dHZW8gPSBuZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeSgzMDAsIDMwMCwgMSwgMSk7XHJcblxyXG4gICAgICAgIHZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2goc2hhZG93R2VvLCBzaGFkb3dNYXRlcmlhbCk7XHJcblxyXG4gICAgICAgIHJldHVybiBtZXNoO1xyXG5cclxuICAgICAgfSxcclxuXHJcbiAgICAgIGNyZWF0ZUljb3NhaGVkcm9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcmFkaXVzPTE7XHJcbiAgICAgICAgdmFyIGNvbG9yLCBmLCBwLCB2ZXJ0ZXhJbmRleCwgZmFjZUluZGljZXMgPSBbJ2EnLCAnYicsICdjJ107XHJcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLkljb3NhaGVkcm9uR2VvbWV0cnkocmFkaXVzLCAxKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBnZW9tZXRyeS5mYWNlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgZiA9IGdlb21ldHJ5LmZhY2VzW2ldO1xyXG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzOyBqKyspIHtcclxuICAgICAgICAgICAgdmVydGV4SW5kZXggPSBmW2ZhY2VJbmRpY2VzW2pdXTtcclxuICAgICAgICAgICAgcCA9IGdlb21ldHJ5LnZlcnRpY2VzW3ZlcnRleEluZGV4XTtcclxuICAgICAgICAgICAgY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoMHhmZmZmZmYpO1xyXG4gICAgICAgICAgICBjb2xvci5zZXRIU0woKHAueSAvIHJhZGl1cyArIDEpIC8gMiwgMS4wLCAwLjUpO1xyXG4gICAgICAgICAgICBmLnZlcnRleENvbG9yc1tqXSA9IGNvbG9yO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1hdGVyaWFscyA9IFtcclxuXHJcbiAgICAgICAgICBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgICBjb2xvcjogMHhmZmZmZmYsXHJcbiAgICAgICAgICAgIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nLFxyXG4gICAgICAgICAgICB2ZXJ0ZXhDb2xvcnM6IFRIUkVFLlZlcnRleENvbG9ycyxcclxuICAgICAgICAgICAgc2hpbmluZXNzOiAwXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgIGNvbG9yOiAweDAwMDAwMCxcclxuICAgICAgICAgICAgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmcsXHJcbiAgICAgICAgICAgIHdpcmVmcmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIF07XHJcbiAgICAgIHJldHVybiBUSFJFRS5TY2VuZVV0aWxzLmNyZWF0ZU11bHRpTWF0ZXJpYWxPYmplY3QoZ2VvbWV0cnksIG1hdGVyaWFscyk7XHJcbiAgICAgIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgIH1cclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeSgnQVJVdGlscycsIGZ1bmN0aW9uKCRpb25pY1BsYXRmb3JtKSB7XHJcblxyXG4gICAgdmFyIHNpemU9ZnVuY3Rpb24oZWxlbSl7XHJcbiAgICAgICAgICAgIGVsZW0ud2lkdGg9d2luZG93LmlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgIGVsZW0uaGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNpemU6c2l6ZSwgXHJcbiAgICAgICAgc2V0VmlkZW9TaXplOmZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICBzaXplKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlbycpKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeShcIkFwaVNlcnZpY2VcIiwgZnVuY3Rpb24oJHJlc291cmNlLCAkbG9jYXRpb24pe1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgLy9lbnY6JGxvY2F0aW9uLmFic1VybCgpLmluZGV4T2YoXCJsb2NhbGhvc3RcIik9PS0xP1wicHJvZFwiOlwiZGV2XCIsXHJcbiAgICAgICAgZW52OlwicHJvZFwiLFxyXG4gICAgICAgIHByb2Q6e1xyXG4gICAgICAgICAgICBwcm90b2NvbDpcImh0dHBzXCIsXHJcbiAgICAgICAgICAgIGhvc3Q6XCJwaWNreW91cmRheS5oZXJva3VhcHAuY29tXCIsXHJcbiAgICAgICAgICAgIHBvcnQ6XCJcIixcclxuICAgICAgICAgICAgcm9vdDpcImFwaVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZXY6e1xyXG4gICAgICAgICAgICBwcm90b2NvbDpcImh0dHBcIixcclxuICAgICAgICAgICAgaG9zdDpcImxvY2FsaG9zdFwiLFxyXG4gICAgICAgICAgICBwb3J0OlwiNTAwMFwiLFxyXG4gICAgICAgICAgICByb290OlwiYXBpXCJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRBcGlQYXRoOmZ1bmN0aW9uKHBhdGgpe1xyXG4gICAgICAgICAgICB2YXIgYXBpPXRoaXNbdGhpcy5lbnZdO1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpLnByb3RvY29sK1wiOi8vXCIrYXBpLmhvc3QrKGFwaS5wb3J0IT09XCJcIj8oXCI6XCIrYXBpLnBvcnQpOlwiXCIpK1wiL1wiK2FwaS5yb290K1wiL1wiK3BhdGg7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcmVzdDpmdW5jdGlvbihwYXRoLCBtZXRob2RzLCBkZWZhdWx0UGFyYW1zKXtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlPSRyZXNvdXJjZShcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXBpUGF0aChwYXRoKSxcclxuICAgICAgICAgICAgICAgIGRlZmF1bHRQYXJhbXMgfHwge30sXHJcbiAgICAgICAgICAgICAgICBtZXRob2RzIHx8IHt9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KTtcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoXCJBdXRoSW50ZXJjZXB0b3JcIiwgZnVuY3Rpb24oJHEsICRsb2NhdGlvbil7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uKGNvbmZpZyl7XHJcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XHJcblxyXG4gICAgICAgICAgICB2YXIgdXNlcj1nZXRKU09OTG9jYWwoXCJ1c2VyXCIpO1xyXG4gICAgICAgICAgICB2YXIgdXNlcj1nZXRKU09OTG9jYWwoXCJ1c2VyXCIpO1xyXG4gICAgICAgICAgICBpZiAoIWNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gJiYgdXNlcikge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IHVzZXIudG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVxdWVzdEVycm9yOiBmdW5jdGlvbihyZWplY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICdFUlJPUicpIHsgLy9Gb3JjZSBlcnJvclxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24ocmVqZWN0aW9uKXtcclxuICAgICAgICAgICAgaWYocmVqZWN0aW9uLnN0YXR1cyA9PT0gNDAzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZSBhY2Nlc28nKTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS51c2VyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVqZWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KFwiT2F1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKEFwaVNlcnZpY2Upe1xyXG5cclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICAgIGJhc2U6XCJvYXV0aFwiLFxyXG4gICAgICAgIGxvZ2luOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnJlc3QodGhpcy5iYXNlLHtcclxuICAgICAgICAgICAgICAgIFNlc3Npb246e21ldGhvZDpcIlBPU1RcIiwgcGFyYW1zOnt9fVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvZ291dDpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5yZXN0KHRoaXMuYmFzZStcIi9sb2dvdXRcIiwge1xyXG4gICAgICAgICAgICAgICAgU2Vzc2lvbjp7bWV0aG9kOlwiR0VUXCIsIHBhcmFtczp7fX1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByb2xlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnJlc3QodGhpcy5iYXNlK1wiL3JvbGUvOnJvbGVcIiwge1xyXG4gICAgICAgICAgICAgICAgICBjaGVjazp7bWV0aG9kOlwiR0VUXCIsIHBhcmFtczp7cm9sZTpcIkByb2xlXCJ9fSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcbn0pO1xyXG5cclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoXCJSZXF1ZXN0U2VydmljZVwiLCBmdW5jdGlvbigpe1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICBcclxuICAgICAgICBTZXJ2ZXJOb3RGb3VuZDogQ2xvc3VyZU1lc3NhZ2UoXCJTZXJ2ZXIgTm90IEZvdW5kXCIpLFxyXG5cclxuICAgICAgICBOb1JvbGVBdXRob3JpemVkOiBDbG9zdXJlTWVzc2FnZShcIk5vIFJvbGUgQXV0aG9yaXplZFwiKSxcclxuICAgICAgICBcclxuICAgIFxyXG4gICAgfTtcclxufSk7XHJcbiJdfQ==
