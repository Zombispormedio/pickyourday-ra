function saveLocal(e,t){localStorage[e]=JSON.stringify(t)}function getJSONLocal(e){var t=null;try{var r=localStorage[e];void 0!==r&&(t=JSON.parse(r))}catch(o){}return t}function deleteLocal(e){localStorage.removeItem(e)}function ClosureMessage(e){return function(t){return function(){t(e)}}}function emptyOrUndefined(e){return void 0==e||""===e}function RandPosition(e){var t=e||{min:0,max:100},r=chance.floating(t),o=chance.floating(t),n=chance.floating(t);return[r,o,n]}function RandColor(e){var t=e||{min:0,max:1,fixed:2},r=chance.floating(t),o=chance.floating(t),n=chance.floating(t);return[r,o,n,1]}function RandSize(e){var t=e||{min:.1,max:2,fixed:1},r=chance.floating(t);return[r,r,r]}function RandRotation(e){var t=Number(chance.bool()),r=Number(chance.bool()),o=Number(chance.bool());return{angle:chance.integer({min:0,max:360}),axis:[t,r,o]}}function generate(e){return function(){var t=chance.integer({min:0,max:100});return Array.apply(0,Array(t)).map(e)}}var app=angular.module("artoolkit",["ionic","ngResource"]);angular.module("artoolkit").run(["$ionicPlatform","$rootScope","$state",function(e,t,r){t.go=function(e,t){r.go(e,t)},e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]),angular.module("artoolkit").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,t,r){e.state("login",{url:"/login",onEnter:["$rootScope",function(e){getJSONLocal("user")&&e.go("app.ar")}],templateUrl:"src/views/login/main.html",controller:"LoginCtrl"}).state("app",{url:"/",onEnter:["$rootScope",function(e){getJSONLocal("user")||e.go("login")}],templateUrl:"src/views/main.html",controller:"AppCtrl","abstract":!0}).state("app.ar",{url:"ar",onEnter:["$rootScope",function(e){getJSONLocal("user")||e.go("login")}],views:{content:{templateUrl:"src/views/ar/main.html",controller:"ARCtrl"}}}),t.otherwise("/login"),r.interceptors.push("AuthInterceptor")}]),angular.module("artoolkit").controller("AppCtrl",["$rootScope","$scope","OauthService",function(e,t,r){t.logout=function(){r.logout().Session(function(t){var r=t;r.error||(deleteLocal("user"),e.go("login"))})}}]),angular.module("artoolkit").controller("ARCtrl",["$scope","ARObject",function(e,t){var r=t.createIcosahedron();e.actions={onCreate:function(e,t){console.log("create"),e.add(r)},onUpdate:function(e,t){console.log("update")},onDestroy:function(e,t){console.log("remove"),e.remove(r)}}}]),angular.module("artoolkit").controller("LoginCtrl",["$rootScope","$scope","OauthService","RequestService",function(e,t,r,o){t.user={email:"",password:""},t.login=function(){async.waterfall([function(e){var r=emptyOrUndefined(t.user.email),o=emptyOrUndefined(t.user.password);r||o?r?e("Email Empty"):o&&e("Password Empty"):e()},function(e){r.login().Session(t.user,function(t){return t.error?e(t.error):void e(null,t.data)},o.ServerNotFound(e))},function(e,t){r.role().check({role:e.role},function(r){return r.error?t(r.error):void(1==r.data||0==r.data?t(null,e):o.NoRoleAuthorized(t)())},o.ServerNotFound(t))}],function(t,r){return t?alert(t):(saveLocal("user",r),void e.go("app.ar"))})}}]),angular.module("artoolkit").directive("arView",["ARUtils","ARCamera","AR","$ionicPlatform",function(e,t,r,o){return{restrict:"A",scope:{actions:"=actions"},link:function(n,a,i){var c=a[0];console.log(n.actions),o.ready(function(){e.size(c),e.setVideoSize(),t.wait(function(){r.init(c,n.actions),r.tick()})})}}}]),angular.module("artoolkit").factory("AR3D",function(){var e=function(e){function t(){a.needsUpdate=!0}var r=new THREE.Camera,o=new THREE.Scene,n=new THREE.PlaneGeometry(2,2,0),a=new THREE.Texture(e);a.generateMipmaps=!1,a.minFilter=THREE.NearestFilter,a.magFilter=THREE.NearestFilter,a.wrapS=a.wrapT=THREE.ClampToEdgeWrapping;var i=new THREE.MeshBasicMaterial({map:a,depthTest:!1,depthWrite:!1}),c=new THREE.Mesh(n,i);return o.add(c),{camera:r,scene:o,update:t}},t=function(){function e(e){r.add(e)}function t(e){r.remove(e)}var r=new THREE.Scene,o=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);return o.position.z=5,{scene:r,camera:o,add:e,remove:t}},r=function(r,o,n){function a(){l.render(s.scene,s.camera),l.render(d.scene,d.camera)}function i(){s.update()}function c(e){d.add(e)}function u(e){d.remove(e)}var l=new THREE.WebGLRenderer({canvas:r,antialias:!0});l.setSize(o.width,o.height),l.setPixelRatio(window.devicePixelRatio),l.autoClear=!1;var s=new e(n),d=new t,f=new THREE.SpotLight(16777215);return f.position.set(0,0,9e3),f.lookAt(new THREE.Vector3(0,0,0)),d.scene.add(f),{add:c,remove:u,update:i,render:a,glCanvas:r,virtual:d.scene}};return{create:r}}),angular.module("artoolkit").factory("ARCamera",["ARUtils","$ionicPlatform",function(e,t){var r=document.getElementById("video"),o=function(e,t,r){var o=void 0;return navigator.getUserMedia?o=navigator.getUserMedia(e,t,r):navigator.webkitGetUserMedia&&(o=navigator.webkitGetUserMedia(e,t,r)),o},n=function(e){return function(t){var o=window.URL||window.webkitURL;r.src=o.createObjectURL(t),r.play(),e()}},a=function(e){console.log("An error occured! "+e)},i=function(e){o({video:!0,audio:!1},n(e),a)},c=function(){return{width:r.width,height:r.height}},u=function(e){e.drawImage(r,0,0)};return{wait:i,copyToContext:u,getDimensions:c}}]),angular.module("artoolkit").factory("ARDetector",function(){function e(e){var t=new NyARRgbRaster_Canvas2D(e),r=new FLARParam(e.width,e.height),o=new FLARMultiIdMarkerDetector(r,120);o.setContinueMode(!0);var n=function(e){var t=o.getIdMarkerData(e);if(t.packetLength>4)return-1;for(var r=0,n=0;n<t.packetLength;n++)r=r<<8|t.getPacketData(n);return r},a=function(e){var t=new NyARTransMatResult;o.getTransformMatrix(e,t);var r=new Float32Array(16);return r[0]=t.m00,r[1]=-t.m10,r[2]=t.m20,r[3]=0,r[4]=t.m01,r[5]=-t.m11,r[6]=t.m21,r[7]=0,r[8]=-t.m02,r[9]=t.m12,r[10]=-t.m22,r[11]=0,r[12]=t.m03,r[13]=-t.m13,r[14]=t.m23,r[15]=1,r},i=function(e,t){var o=new Float32Array(16);return r.copyCameraMatrix(o,e,t),o},c=1,u=function(e,t){return{id:e,matrix:t,age:c}},l={},s=function(e,r,i){for(var s=o.detectMarkerLite(t,70),d=0;s>d;d++){var f=n(d),g=l[f];void 0===g?(g=u(f,a(d)),l[f]=g,e(g)):(g.matrix=a(d),g.age=c,r(g))}for(var f in l){var g=l[f];g&&0==g.age--&&(i(g),delete l[f])}};return{detect:s,getCameraMatrix:i}}return{create:e}}),angular.module("artoolkit").factory("AR",["ARCamera","ARDetector","AR3D","ARMarker",function(e,t,r,o){var n,a,i,c,u,l=function(l,s){s=s||{},u={},n=document.createElement("canvas");var d=e.getDimensions();n.width=d.width,n.height=d.height,a=n.getContext("2d"),i=t.create(n),c=r.create(l,d,n),u.onCreate=o.Primitive(c,s.onCreate||o.onCreate),u.onUpdate=o.Primitive(c,s.onUpdate||o.onUpdate),u.onDestroy=o.Primitive(c,s.onDestroy||o.onDestroy)},s=function(){e.copyToContext(a),n.changed=!0,i.detect(u.onCreate,u.onUpdate,u.onDestroy),c.update(),c.render(),window.requestAnimationFrame(s)};return{init:l,tick:s}}]),angular.module("artoolkit").factory("ARMarker",["ARObject",function(e){var t={16:e.createBasicCube({color:13369344}),32:e.createBasicCube({color:52224}),64:e.createBasicCube({color:204})},r=function(e,r){console.log("Created"),console.log(r.id);var o=t[r.id];o.rotation.x+=.1,o.rotation.y+=.1,e.add(o)},o=function(e,r){console.log("update"),console.log(r.id);var o=t[r.id];o.rotation.x+=.1,o.rotation.y+=.1},n=function(e,r){console.log("remove"),console.log(r.id);var o=t[r.id];e.remove(o)},a=function(e,t){return function(r){t(e,r)}};return{Primitive:a,onCreate:r,onUpdate:o,onDestroy:n}}]),angular.module("artoolkit").factory("ARObject",function(){return{createBasicCube:function(e){var t=new THREE.BoxGeometry(1,1,1),r=new THREE.MeshBasicMaterial({color:e}),o=new THREE.Mesh(t,r);return o.position.z=-5,o},createPhongCube:function(){var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshPhongMaterial({color:8375321,shininess:230}),r=new THREE.Mesh(e,t);return r},createGradientPlane:function(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);r.addColorStop(.1,"rgba(210,210,210,1)"),r.addColorStop(1,"rgba(255,255,255,1)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height);var o=new THREE.Texture(e);o.needsUpdate=!0;var n=new THREE.MeshBasicMaterial({map:o}),a=new THREE.PlaneBufferGeometry(300,300,1,1),i=new THREE.Mesh(a,n);return i},createIcosahedron:function(){for(var e,t,r,o,n=1,a=["a","b","c"],i=new THREE.IcosahedronGeometry(n,1),c=0;c<i.faces.length;c++){t=i.faces[c];for(var u=0;3>u;u++)o=t[a[u]],r=i.vertices[o],e=new THREE.Color(16777215),e.setHSL((r.y/n+1)/2,1,.5),t.vertexColors[u]=e}var l=[new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,vertexColors:THREE.VertexColors,shininess:0}),new THREE.MeshBasicMaterial({color:0,shading:THREE.FlatShading,wireframe:!0,transparent:!0})];return THREE.SceneUtils.createMultiMaterialObject(i,l)}}}),angular.module("artoolkit").factory("ARUtils",["$ionicPlatform",function(e){var t=function(e){e.width=window.innerWidth,e.height=window.innerHeight};return{size:t,setVideoSize:function(){t(document.getElementById("video"))}}}]),angular.module("artoolkit").factory("ApiService",["$resource","$location",function(e,t){return{env:"prod",prod:{protocol:"https",host:"pickyourday.herokuapp.com",port:"",root:"api"},dev:{protocol:"http",host:"localhost",port:"5000",root:"api"},getApiPath:function(e){var t=this[this.env];return t.protocol+"://"+t.host+(""!==t.port?":"+t.port:"")+"/"+t.root+"/"+e},rest:function(t,r,o){var n=e(this.getApiPath(t),o||{},r||{});return n}}}]),angular.module("artoolkit").factory("AuthInterceptor",["$q","$location",function(e,t){return{request:function(e){e.headers=e.headers||{};var t=getJSONLocal("user"),t=getJSONLocal("user");return!e.headers.Authorization&&t&&(e.headers.Authorization=t.token),e},requestError:function(t){return e.reject(t)},response:function(t){return"ERROR"===t.data.status?e.reject(t):t||e.when(t)},responseError:function(r){return 403===r.status?(console.error("Error de acceso"),localStorage.user="",void t.path("/")):e.reject(r)}}}]),angular.module("artoolkit").factory("OauthService",["ApiService",function(e){return{base:"oauth",login:function(){return e.rest(this.base,{Session:{method:"POST",params:{}}})},logout:function(){return e.rest(this.base+"/logout",{Session:{method:"GET",params:{}}})},role:function(){return e.rest(this.base+"/role/:role",{check:{method:"GET",params:{role:"@role"}}})}}}]),angular.module("artoolkit").factory("RequestService",function(){return{ServerNotFound:ClosureMessage("Server Not Found"),NoRoleAuthorized:ClosureMessage("No Role Authorized")}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdXRpbHMuanMiLCJhcHAuanMiLCJjb25maWcvYm9vdC5qcyIsImNvbmZpZy9lbnZpcm9ubWVudC5qcyIsImNvbnRyb2xsZXJzL2FwcF9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvYXJfY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL2xvZ2luX2NvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvYXJfdmlld19kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl8zZF9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfY2FtZXJhX2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl9kZXRlY3Rvcl9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfZmFjdG9yeS5qcyIsImNvbXBvbmVudHMvZmFjdG9yaWVzL2FyX21hcmtlcl9mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9mYWN0b3JpZXMvYXJfb2JqZWN0X2ZhY3RvcnkuanMiLCJjb21wb25lbnRzL2ZhY3Rvcmllcy9hcl91dGlsc19mYWN0b3J5LmpzIiwiY29tcG9uZW50cy9zZXJ2aWNlcy9hcGkuc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvaW50ZXJjZXB0b3Jfc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvb2F1dGguc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvcmVxdWVzdF9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbInNhdmVMb2NhbCIsImtleSIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SlNPTkxvY2FsIiwicmVzdWx0Iiwic3RyX2pzb24iLCJ1bmRlZmluZWQiLCJwYXJzZSIsImUiLCJkZWxldGVMb2NhbCIsInJlbW92ZUl0ZW0iLCJDbG9zdXJlTWVzc2FnZSIsIm1lc3NhZ2UiLCJmbiIsImVtcHR5T3JVbmRlZmluZWQiLCJ2YWx1ZSIsIlJhbmRQb3NpdGlvbiIsInYiLCJyYW5nZSIsIm1pbiIsIm1heCIsIngiLCJjaGFuY2UiLCJmbG9hdGluZyIsInkiLCJ6IiwiUmFuZENvbG9yIiwicmFuZ2VDb2xvciIsImZpeGVkIiwiciIsImciLCJiIiwiUmFuZFNpemUiLCJzaXplIiwiUmFuZFJvdGF0aW9uIiwiTnVtYmVyIiwiYm9vbCIsImFuZ2xlIiwiaW50ZWdlciIsImF4aXMiLCJnZW5lcmF0ZSIsImNvdW50IiwiQXJyYXkiLCJhcHBseSIsIm1hcCIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkaW9uaWNQbGF0Zm9ybSIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJnbyIsInN0YXRlIiwicGFyYW1zIiwicmVhZHkiLCJ3aW5kb3ciLCJjb3Jkb3ZhIiwicGx1Z2lucyIsIktleWJvYXJkIiwiaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyIiwiZGlzYWJsZVNjcm9sbCIsIlN0YXR1c0JhciIsInN0eWxlRGVmYXVsdCIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsInVybCIsIm9uRW50ZXIiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJhYnN0cmFjdCIsInZpZXdzIiwiY29udGVudCIsIm90aGVyd2lzZSIsImludGVyY2VwdG9ycyIsInB1c2giLCIkc2NvcGUiLCJPYXV0aFNlcnZpY2UiLCJsb2dvdXQiLCJTZXNzaW9uIiwicmVzIiwiZXJyb3IiLCJBUk9iamVjdCIsIm9iamVjdCIsImNyZWF0ZUljb3NhaGVkcm9uIiwiYWN0aW9ucyIsIm9uQ3JlYXRlIiwidmlldyIsIm1hcmtlciIsImNvbnNvbGUiLCJsb2ciLCJhZGQiLCJvblVwZGF0ZSIsIm9uRGVzdHJveSIsInJlbW92ZSIsIlJlcXVlc3RTZXJ2aWNlIiwidXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCJsb2dpbiIsImFzeW5jIiwid2F0ZXJmYWxsIiwibmV4dCIsImlzRW1haWwiLCJpc1Bhc3N3b3JkIiwiU2VydmVyTm90Rm91bmQiLCJyb2xlIiwiY2hlY2siLCJOb1JvbGVBdXRob3JpemVkIiwiZXJyIiwiYWxlcnQiLCJkaXJlY3RpdmUiLCJBUlV0aWxzIiwiQVJDYW1lcmEiLCJBUiIsInJlc3RyaWN0Iiwic2NvcGUiLCJsaW5rIiwidEVsZW1lbnQiLCJhdHRycyIsImVsZW0iLCJzZXRWaWRlb1NpemUiLCJ3YWl0IiwiaW5pdCIsInRpY2siLCJmYWN0b3J5IiwiUmVhbGl0eSIsInNvdXJjZUNhbnZhcyIsInVwZGF0ZSIsInRleHR1cmUiLCJuZWVkc1VwZGF0ZSIsImNhbWVyYSIsIlRIUkVFIiwiQ2FtZXJhIiwic2NlbmUiLCJTY2VuZSIsImdlb21ldHJ5IiwiUGxhbmVHZW9tZXRyeSIsIlRleHR1cmUiLCJnZW5lcmF0ZU1pcG1hcHMiLCJtaW5GaWx0ZXIiLCJOZWFyZXN0RmlsdGVyIiwibWFnRmlsdGVyIiwid3JhcFMiLCJ3cmFwVCIsIkNsYW1wVG9FZGdlV3JhcHBpbmciLCJtYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiZGVwdGhUZXN0IiwiZGVwdGhXcml0ZSIsIm1lc2giLCJNZXNoIiwiUGVyc3BlY3RpdmVDYW1lcmEiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwb3NpdGlvbiIsImNyZWF0ZSIsImdsQ2FudmFzIiwiZGltZW5zaW9ucyIsInJlbmRlciIsInJlbmRlcmVyIiwicmVhbGl0eSIsInZpcnR1YWwiLCJXZWJHTFJlbmRlcmVyIiwiY2FudmFzIiwiYW50aWFsaWFzIiwic2V0U2l6ZSIsIndpZHRoIiwiaGVpZ2h0Iiwic2V0UGl4ZWxSYXRpbyIsImRldmljZVBpeGVsUmF0aW8iLCJhdXRvQ2xlYXIiLCJsaWdodCIsIlNwb3RMaWdodCIsInNldCIsImxvb2tBdCIsIlZlY3RvcjMiLCJ2aWRlbyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRNZWRpYUNhcHR1cmUiLCJ0Iiwib25zdWNjZXNzIiwib25lcnJvciIsIm5hdmlnYXRvciIsImdldFVzZXJNZWRpYSIsIndlYmtpdEdldFVzZXJNZWRpYSIsIm9uU3VjY2VzcyIsImNiIiwic3RyZWFtIiwidmVuZG9yVVJMIiwiVVJMIiwid2Via2l0VVJMIiwic3JjIiwiY3JlYXRlT2JqZWN0VVJMIiwicGxheSIsIm9uRXJyb3IiLCJ3YWl0Q2FtZXJhIiwiY2FsbGJhY2siLCJhdWRpbyIsImdldERpbWVuc2lvbnMiLCJjb3B5VG9Db250ZXh0IiwiY29udGV4dCIsImRyYXdJbWFnZSIsIkpTQVJSYXN0ZXIiLCJOeUFSUmdiUmFzdGVyX0NhbnZhczJEIiwiSlNBUlBhcmFtZXRlcnMiLCJGTEFSUGFyYW0iLCJKU0FSRGV0ZWN0b3IiLCJGTEFSTXVsdGlJZE1hcmtlckRldGVjdG9yIiwic2V0Q29udGludWVNb2RlIiwiZ2V0TWFya2VyTnVtYmVyIiwiaWR4IiwiZ2V0SWRNYXJrZXJEYXRhIiwicGFja2V0TGVuZ3RoIiwiaSIsImdldFBhY2tldERhdGEiLCJnZXRUcmFuc2Zvcm1NYXRyaXgiLCJtYXQiLCJOeUFSVHJhbnNNYXRSZXN1bHQiLCJjbSIsIkZsb2F0MzJBcnJheSIsIm0wMCIsIm0xMCIsIm0yMCIsIm0wMSIsIm0xMSIsIm0yMSIsIm0wMiIsIm0xMiIsIm0yMiIsIm0wMyIsIm0xMyIsIm0yMyIsImdldENhbWVyYU1hdHJpeCIsInpOZWFyIiwiekZhciIsImNvcHlDYW1lcmFNYXRyaXgiLCJwZXJzaXN0VGltZSIsIm5ld01hcmtlciIsImlkIiwibWF0cml4IiwiYWdlIiwibWFya2VycyIsImRldGVjdCIsIm1hcmtlckNvdW50IiwiZGV0ZWN0TWFya2VyTGl0ZSIsImluZGV4IiwiQVJEZXRlY3RvciIsIkFSM0QiLCJBUk1hcmtlciIsImRldGVjdG9yIiwibWFya2VyX2FjdGlvbnMiLCJjcmVhdGVFbGVtZW50IiwiY2FtZXJhRGltZW5zaW9ucyIsImdldENvbnRleHQiLCJQcmltaXRpdmUiLCJjaGFuZ2VkIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib2JqZWN0cyIsIjE2IiwiY3JlYXRlQmFzaWNDdWJlIiwiY29sb3IiLCIzMiIsIjY0Iiwicm90YXRpb24iLCJCb3hHZW9tZXRyeSIsImN1YmUiLCJjcmVhdGVQaG9uZ0N1YmUiLCJNZXNoUGhvbmdNYXRlcmlhbCIsInNoaW5pbmVzcyIsImNyZWF0ZUdyYWRpZW50UGxhbmUiLCJncmFkaWVudCIsImNyZWF0ZVJhZGlhbEdyYWRpZW50IiwiYWRkQ29sb3JTdG9wIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJzaGFkb3dUZXh0dXJlIiwic2hhZG93TWF0ZXJpYWwiLCJzaGFkb3dHZW8iLCJQbGFuZUJ1ZmZlckdlb21ldHJ5IiwiZiIsInAiLCJ2ZXJ0ZXhJbmRleCIsInJhZGl1cyIsImZhY2VJbmRpY2VzIiwiSWNvc2FoZWRyb25HZW9tZXRyeSIsImZhY2VzIiwibGVuZ3RoIiwiaiIsInZlcnRpY2VzIiwiQ29sb3IiLCJzZXRIU0wiLCJ2ZXJ0ZXhDb2xvcnMiLCJtYXRlcmlhbHMiLCJzaGFkaW5nIiwiRmxhdFNoYWRpbmciLCJWZXJ0ZXhDb2xvcnMiLCJ3aXJlZnJhbWUiLCJ0cmFuc3BhcmVudCIsIlNjZW5lVXRpbHMiLCJjcmVhdGVNdWx0aU1hdGVyaWFsT2JqZWN0IiwiJHJlc291cmNlIiwiJGxvY2F0aW9uIiwiZW52IiwicHJvZCIsInByb3RvY29sIiwiaG9zdCIsInBvcnQiLCJyb290IiwiZGV2IiwiZ2V0QXBpUGF0aCIsInBhdGgiLCJhcGkiLCJ0aGlzIiwicmVzdCIsIm1ldGhvZHMiLCJkZWZhdWx0UGFyYW1zIiwicmVzb3VyY2UiLCIkcSIsInJlcXVlc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInRva2VuIiwicmVxdWVzdEVycm9yIiwicmVqZWN0aW9uIiwicmVqZWN0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJ3aGVuIiwicmVzcG9uc2VFcnJvciIsIkFwaVNlcnZpY2UiLCJiYXNlIiwibWV0aG9kIl0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxXQUFBQyxFQUFBQyxHQUNBQyxhQUFBRixHQUFBRyxLQUFBQyxVQUFBSCxHQUdBLFFBQUFJLGNB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OFAsT0FBQSxNQUFBelIsY0FHQXNELEtBQUEsV0FDQSxNQUFBaU8sR0FBQWhCLEtBQUFELEtBQUFrQixLQUFBLGVBQ0FqTyxPQUFBa08sT0FBQSxNQUFBelIsUUFBQXNELEtBQUEsaUJDbEJBOUQsUUFBQUMsT0FBQSxhQUNBZ0YsUUFBQSxpQkFBQSxXQUVBLE9BRUFwQixlQUFBaEcsZUFBQSxvQkFFQW1HLGlCQUFBbkcsZUFBQSIsImZpbGUiOiJwaWNreW91cmRheS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzYXZlTG9jYWwoa2V5LCBkYXRhKSB7XHJcbiAgICBsb2NhbFN0b3JhZ2Vba2V5XSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRKU09OTG9jYWwoa2V5KSB7XHJcblxyXG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBzdHJfanNvbiA9IGxvY2FsU3RvcmFnZVtrZXldO1xyXG5cclxuICAgICAgICBpZiAoc3RyX2pzb24hPT11bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2Uoc3RyX2pzb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUxvY2FsKGtleSkge1xyXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gQ2xvc3VyZU1lc3NhZ2UobWVzc2FnZSl7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oZm4pe1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBmbihtZXNzYWdlKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW1wdHlPclVuZGVmaW5lZCh2YWx1ZSl7XHJcbiAgICByZXR1cm4gdmFsdWU9PXZvaWQgMCB8fCB2YWx1ZT09PVwiXCI7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBSYW5kUG9zaXRpb24odikge1xyXG4gICAgdmFyIHJhbmdlID0gdiB8fCB7IG1pbjogMCwgbWF4OiAxMDAgfTtcclxuICAgIHZhciB4ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHZhciB5ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHZhciB6ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHJldHVybiBbeCwgeSwgel07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFJhbmRDb2xvcih2KSB7XHJcbiAgICB2YXIgcmFuZ2VDb2xvciA9IHYgfHwgeyBtaW46IDAsIG1heDogMSwgZml4ZWQ6IDIgfTtcclxuICAgIHZhciByID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlQ29sb3IpO1xyXG4gICAgdmFyIGcgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2VDb2xvcik7XHJcbiAgICB2YXIgYiA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZUNvbG9yKTtcclxuICAgIHJldHVybiBbciwgZywgYiwgMV07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFJhbmRTaXplKHYpIHtcclxuICAgIHZhciByYW5nZSA9IHYgfHwgeyBtaW46IDAuMSwgbWF4OiAyLCBmaXhlZDogMSB9O1xyXG4gICAgdmFyIHNpemUgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2UpO1xyXG4gICAgcmV0dXJuIFtzaXplLCBzaXplLCBzaXplXTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIFJhbmRSb3RhdGlvbih2KXtcclxuICAgIHZhciByYW5nZSA9IHYgfHwgeyBtaW46IDAsIG1heDogMzYwfTtcclxuICAgIHZhciB4PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHZhciB5PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHZhciB6PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHJldHVybiAge1xyXG4gICAgICAgIGFuZ2xlOmNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDM2MH0pLFxyXG4gICAgICAgIGF4aXM6W3gseSx6XVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGUoZm4pIHtcclxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY291bnQgPSBjaGFuY2UuaW50ZWdlcih7IG1pbjogMCwgbWF4OiAxMDAgfSk7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmFwcGx5KDAsIEFycmF5KGNvdW50KSkubWFwKGZuKTtcclxuICAgIH07XHJcbn0iLCJ2YXIgYXBwPWFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnLCBbJ2lvbmljJywgJ25nUmVzb3VyY2UnXSlcblxuXG4gICAgICAgICAgXG5cdFx0IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAucnVuKGZ1bmN0aW9uKCRpb25pY1BsYXRmb3JtLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcclxuXHJcbiAgICAkcm9vdFNjb3BlLmdvID0gZnVuY3Rpb24gKHN0YXRlLCBwYXJhbXMpIHtcclxuICAgICAgICAkc3RhdGUuZ28oc3RhdGUsIHBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgJGlvbmljUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZCkge1xyXG4gICAgICAgICAgICAvLyBIaWRlIHRoZSBhY2Nlc3NvcnkgYmFyIGJ5IGRlZmF1bHQgKHJlbW92ZSB0aGlzIHRvIHNob3cgdGhlIGFjY2Vzc29yeSBiYXIgYWJvdmUgdGhlIGtleWJvYXJkXHJcbiAgICAgICAgICAgIC8vIGZvciBmb3JtIGlucHV0cylcclxuICAgICAgICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmhpZGVLZXlib2FyZEFjY2Vzc29yeUJhcih0cnVlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIERvbid0IHJlbW92ZSB0aGlzIGxpbmUgdW5sZXNzIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZy4gSXQgc3RvcHMgdGhlIHZpZXdwb3J0XHJcbiAgICAgICAgICAgIC8vIGZyb20gc25hcHBpbmcgd2hlbiB0ZXh0IGlucHV0cyBhcmUgZm9jdXNlZC4gSW9uaWMgaGFuZGxlcyB0aGlzIGludGVybmFsbHkgZm9yXHJcbiAgICAgICAgICAgIC8vIGEgbXVjaCBuaWNlciBrZXlib2FyZCBleHBlcmllbmNlLlxyXG4gICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuZGlzYWJsZVNjcm9sbCh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYod2luZG93LlN0YXR1c0Jhcikge1xyXG4gICAgICAgICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xyXG4gICAgXHJcbiAgICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgICAuc3RhdGUoXCJsb2dpblwiLCB7XHJcbiAgICAgICAgdXJsOiBcIi9sb2dpblwiLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmIChnZXRKU09OTG9jYWwoXCJ1c2VyXCIpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImFwcC5hclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzcmMvdmlld3MvbG9naW4vbWFpbi5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyAgICAgIFxyXG5cclxuICAgIH0pXHJcbiAgICAgICAgLnN0YXRlKFwiYXBwXCIsIHtcclxuICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICBpZiAoIWdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnc3JjL3ZpZXdzL21haW4uaHRtbCcsXHJcbiAgICAgICAgY29udHJvbGxlcjogJ0FwcEN0cmwnLFxyXG4gICAgICAgIGFic3RyYWN0OnRydWVcclxuXHJcbiAgICB9KVxyXG4gICAgICAgICAuc3RhdGUoXCJhcHAuYXJcIiwge1xyXG4gICAgICAgIHVybDogJ2FyJyxcclxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICBpZiAoIWdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3JjL3ZpZXdzL2FyL21haW4uaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQVJDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9sb2dpblwiKTtcclxuXHJcbiAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdBdXRoSW50ZXJjZXB0b3InKTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuY29udHJvbGxlcignQXBwQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgIE9hdXRoU2VydmljZSkge1xyXG5cclxuICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRPYXV0aFNlcnZpY2UubG9nb3V0KCkuU2Vzc2lvbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0O1xyXG4gICAgICAgICAgICBpZiAoIXJlcy5lcnJvcikgeyAgICAgICBcclxuICAgICAgICAgICAgICBcdGRlbGV0ZUxvY2FsKFwidXNlclwiKTtcclxuXHRcdFx0ICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcblx0fVxyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuY29udHJvbGxlcignQVJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBBUk9iamVjdCkge1xyXG5cclxuXHJcbiAgICB2YXIgb2JqZWN0PSBBUk9iamVjdC5jcmVhdGVJY29zYWhlZHJvbigpO1xyXG5cclxuXHJcbiAgICAkc2NvcGUuYWN0aW9ucz17XHJcblxyXG4gICAgICAgIG9uQ3JlYXRlOmZ1bmN0aW9uKHZpZXcsIG1hcmtlcil7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlXCIpXHJcbiAgICAgICAgICAgIHZpZXcuYWRkKG9iamVjdCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvblVwZGF0ZTpmdW5jdGlvbih2aWV3LCBtYXJrZXIpe1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVwiKVxyXG5cclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkRlc3Ryb3k6ZnVuY3Rpb24odmlldywgbWFya2VyKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZW1vdmVcIilcclxuICAgICAgICAgICAgdmlldy5yZW1vdmUob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIE9hdXRoU2VydmljZSwgUmVxdWVzdFNlcnZpY2Upe1xyXG4gICAgXHJcblxyXG4gICAgXHJcbiAgICAkc2NvcGUudXNlciA9IHtlbWFpbDpcIlwiLCBwYXNzd29yZDpcIlwifTtcclxuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3luYy53YXRlcmZhbGwoW1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGUobmV4dCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNFbWFpbD1lbXB0eU9yVW5kZWZpbmVkKCRzY29wZS51c2VyLmVtYWlsKTtcclxuICAgICAgICAgICAgICAgIHZhciBpc1Bhc3N3b3JkPWVtcHR5T3JVbmRlZmluZWQoJHNjb3BlLnVzZXIucGFzc3dvcmQpO1xyXG4gICAgICAgICAgICAgICAgaWYoaXNFbWFpbCB8fCBpc1Bhc3N3b3JkKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihpc0VtYWlsKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChcIkVtYWlsIEVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpc1Bhc3N3b3JkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChcIlBhc3N3b3JkIEVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2dpbihuZXh0KXtcclxuXHJcbiAgICAgICAgICAgICAgICBPYXV0aFNlcnZpY2UubG9naW4oKS5TZXNzaW9uKCRzY29wZS51c2VyLCBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlcy5lcnJvcilyZXR1cm4gbmV4dChyZXMuZXJyb3IpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBuZXh0KG51bGwsIHJlcy5kYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LCBSZXF1ZXN0U2VydmljZS5TZXJ2ZXJOb3RGb3VuZChuZXh0KSk7XHJcblxyXG4gICAgICAgICAgICB9LCBcclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tSb2xlKHVzZXIsIG5leHQpe1xyXG4gICAgICAgICAgICAgICAgT2F1dGhTZXJ2aWNlLnJvbGUoKS5jaGVjayh7cm9sZTp1c2VyLnJvbGV9LCBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlcy5lcnJvcilyZXR1cm4gbmV4dChyZXMuZXJyb3IpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YT09MXx8cmVzLmRhdGE9PTApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChudWxsLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdFNlcnZpY2UuTm9Sb2xlQXV0aG9yaXplZChuZXh0KSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9LCBSZXF1ZXN0U2VydmljZS5TZXJ2ZXJOb3RGb3VuZChuZXh0KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICBdLCBmdW5jdGlvbihlcnIsIHVzZXIpe1xyXG4gICAgICAgICAgICBpZihlcnIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFsZXJ0KGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2F2ZUxvY2FsKFwidXNlclwiLCB1c2VyKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImFwcC5hclwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5kaXJlY3RpdmUoJ2FyVmlldycsIGZ1bmN0aW9uKEFSVXRpbHMsIEFSQ2FtZXJhLCBBUiwgJGlvbmljUGxhdGZvcm0pIHtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgIHNjb3BlOntcclxuICAgICAgICAgICAgYWN0aW9uczpcIj1hY3Rpb25zXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxpbms6ZnVuY3Rpb24oc2NvcGUsIHRFbGVtZW50LCBhdHRycyl7XHJcbiAgICAgICAgICAgIHZhciBlbGVtPXRFbGVtZW50WzBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2NvcGUuYWN0aW9ucylcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgQVJVdGlscy5zaXplKGVsZW0pO1xyXG4gICAgICAgICAgICAgICAgQVJVdGlscy4gc2V0VmlkZW9TaXplKCk7XHJcbiAgICAgICAgICAgICAgICBBUkNhbWVyYS53YWl0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgQVIuaW5pdChlbGVtLCBzY29wZS5hY3Rpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICBBUi50aWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeSgnQVIzRCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuXHJcbiAgICB2YXIgUmVhbGl0eT1mdW5jdGlvbihzb3VyY2VDYW52YXMpe1xyXG5cclxuICAgICAgICB2YXIgY2FtZXJhPSBuZXcgVEhSRUUuQ2FtZXJhKCk7XHJcbiAgICAgICAgdmFyIHNjZW5lPSBuZXcgVEhSRUUuU2NlbmUoKTtcclxuXHJcbiAgICAgICAgdmFyIGdlb21ldHJ5PSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSgyLDIsMCk7XHJcbiAgICAgICAgdmFyIHRleHR1cmU9bmV3IFRIUkVFLlRleHR1cmUoc291cmNlQ2FudmFzKTtcclxuICAgICAgICB0ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcyA9IGZhbHNlO1xyXG4gICAgICAgIHRleHR1cmUubWluRmlsdGVyID0gVEhSRUUuTmVhcmVzdEZpbHRlcjtcclxuICAgICAgICB0ZXh0dXJlLm1hZ0ZpbHRlciA9IFRIUkVFLk5lYXJlc3RGaWx0ZXI7XHJcbiAgICAgICAgdGV4dHVyZS53cmFwUyA9IHRleHR1cmUud3JhcFQgPVRIUkVFLkNsYW1wVG9FZGdlV3JhcHBpbmc7XHJcblxyXG5cclxuICAgICAgICB2YXIgbWF0ZXJpYWw9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgIG1hcDp0ZXh0dXJlLFxyXG4gICAgICAgICAgICBkZXB0aFRlc3Q6ZmFsc2UsXHJcbiAgICAgICAgICAgIGRlcHRoV3JpdGU6ZmFsc2VcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIG1lc2g9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XHJcbiAgICAgICAgc2NlbmUuYWRkKG1lc2gpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKXtcclxuICAgICAgICAgICAgdGV4dHVyZS5uZWVkc1VwZGF0ZT10cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FtZXJhOiBjYW1lcmEsXHJcbiAgICAgICAgICAgIHNjZW5lOiBzY2VuZSxcclxuICAgICAgICAgICAgdXBkYXRlOiB1cGRhdGUsIFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFNjZW5lID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XHJcbiAgICAgICAgdmFyIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNzUsIHdpbmRvdy5pbm5lcldpZHRoL3dpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAxMDAwICk7XHJcbiAgICAgICAgXHRjYW1lcmEucG9zaXRpb24ueiA9IDU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFkZChvYmplY3QpIHtcclxuXHJcbiAgICAgICAgICAgIHNjZW5lLmFkZChvYmplY3QpO1xyXG5cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmUob2JqZWN0KSB7XHJcbiAgICAgICAgICAgIHNjZW5lLnJlbW92ZShvYmplY3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2NlbmU6c2NlbmUsXHJcbiAgICAgICAgICAgIGNhbWVyYTpjYW1lcmEsXHJcbiAgICAgICAgICAgIGFkZDphZGQsXHJcbiAgICAgICAgICAgIHJlbW92ZTpyZW1vdmVcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHZhciBjcmVhdGU9ZnVuY3Rpb24oZ2xDYW52YXMsIGRpbWVuc2lvbnMsIHNvdXJjZUNhbnZhcyl7XHJcblxyXG4gICAgICAgIHZhciByZW5kZXJlcj1uZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7Y2FudmFzOmdsQ2FudmFzLCBhbnRpYWxpYXM6IHRydWUgfSk7XHJcbiAgICAgICAgcmVuZGVyZXIuc2V0U2l6ZShkaW1lbnNpb25zLndpZHRoLCBkaW1lbnNpb25zLmhlaWdodCk7XHJcbiAgICAgICAgcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyggd2luZG93LmRldmljZVBpeGVsUmF0aW8gKTtcclxuICAgICAgICByZW5kZXJlci5hdXRvQ2xlYXI9ZmFsc2U7XHJcblxyXG4gICAgICAgIHZhciByZWFsaXR5PSBuZXcgUmVhbGl0eShzb3VyY2VDYW52YXMpO1xyXG4gICAgICAgIHZhciB2aXJ0dWFsPSBuZXcgU2NlbmUoKTtcclxuXHJcbiAgICAgICAgdmFyIGxpZ2h0PW5ldyBUSFJFRS5TcG90TGlnaHQoMHhmZmZmZmYpO1xyXG4gICAgICAgIGxpZ2h0LnBvc2l0aW9uLnNldCgwLDAsOTAwMCk7XHJcbiAgICAgICAgbGlnaHQubG9va0F0KG5ldyBUSFJFRS5WZWN0b3IzKDAsMCwwKSk7XHJcbiAgICAgICAgdmlydHVhbC5zY2VuZS5hZGQobGlnaHQpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcigpe1xyXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXIocmVhbGl0eS5zY2VuZSwgcmVhbGl0eS5jYW1lcmEpO1xyXG5cclxuICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyKHZpcnR1YWwuc2NlbmUsIHZpcnR1YWwuY2FtZXJhKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKXtcclxuICAgICAgICAgICAgIHJlYWxpdHkudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhZGQob2JqZWN0KXtcclxuICAgICAgICAgICAgICB2aXJ0dWFsLmFkZChvYmplY3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIFxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmUob2JqZWN0KXtcclxuICAgICAgICAgICAgIHZpcnR1YWwucmVtb3ZlKG9iamVjdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhZGQ6IGFkZCxcclxuICAgICAgICAgICAgcmVtb3ZlOiByZW1vdmUsXHJcbiAgICAgICAgICAgIHVwZGF0ZTogdXBkYXRlLFxyXG4gICAgICAgICAgICByZW5kZXI6IHJlbmRlcixcclxuICAgICAgICAgICAgZ2xDYW52YXM6IGdsQ2FudmFzLFxyXG4gICAgICAgICAgICB2aXJ0dWFsOnZpcnR1YWwuc2NlbmVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY3JlYXRlOmNyZWF0ZVxyXG4gICAgfVxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeSgnQVJDYW1lcmEnLCBmdW5jdGlvbiggQVJVdGlscywgJGlvbmljUGxhdGZvcm0pIHtcclxuXHJcbiAgICB2YXIgdmlkZW89IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlbycpO1xyXG4gXHJcbiAgICB2YXIgZ2V0TWVkaWFDYXB0dXJlID0gZnVuY3Rpb24odCwgb25zdWNjZXNzLCBvbmVycm9yKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBpZiAobmF2aWdhdG9yLmdldFVzZXJNZWRpYSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHQsIG9uc3VjY2Vzcywgb25lcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEodCwgb25zdWNjZXNzLCBvbmVycm9yKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBvblN1Y2Nlc3M9ZnVuY3Rpb24oY2Ipe1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzdHJlYW0pe1xyXG4gICAgICAgICAgICB2YXIgdmVuZG9yVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMO1xyXG4gICAgICAgICAgICB2aWRlby5zcmMgPSB2ZW5kb3JVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7XHJcbiAgICAgICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgdmFyIG9uRXJyb3I9ZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkFuIGVycm9yIG9jY3VyZWQhIFwiICsgZXJyKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHdhaXRDYW1lcmE9ZnVuY3Rpb24oY2FsbGJhY2spe1xyXG5cclxuICAgICAgICBnZXRNZWRpYUNhcHR1cmUoe3ZpZGVvOiB0cnVlLGF1ZGlvOiBmYWxzZX0sIG9uU3VjY2VzcyhjYWxsYmFjayksIG9uRXJyb3IpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YXIgZ2V0RGltZW5zaW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOnZpZGVvLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6dmlkZW8uaGVpZ2h0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBjb3B5VG9Db250ZXh0PWZ1bmN0aW9uKGNvbnRleHQpe1xyXG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHZpZGVvLCAwLDApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgd2FpdDp3YWl0Q2FtZXJhLFxyXG4gICAgICAgIGNvcHlUb0NvbnRleHQ6Y29weVRvQ29udGV4dCxcclxuICAgICAgICBnZXREaW1lbnNpb25zOmdldERpbWVuc2lvbnNcclxuICAgIH1cclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSRGV0ZWN0b3InLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGUoc291cmNlQ2FudmFzKXtcclxuICAgICAgIHZhciBKU0FSUmFzdGVyID0gbmV3IE55QVJSZ2JSYXN0ZXJfQ2FudmFzMkQoc291cmNlQ2FudmFzKTtcclxuICAgICAgICB2YXIgSlNBUlBhcmFtZXRlcnMgPSBuZXcgRkxBUlBhcmFtKHNvdXJjZUNhbnZhcy53aWR0aCwgc291cmNlQ2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgdmFyIEpTQVJEZXRlY3RvciA9IG5ldyBGTEFSTXVsdGlJZE1hcmtlckRldGVjdG9yKEpTQVJQYXJhbWV0ZXJzLCAxMjApO1xyXG4gICAgICAgIEpTQVJEZXRlY3Rvci5zZXRDb250aW51ZU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIHZhciBnZXRNYXJrZXJOdW1iZXIgPSBmdW5jdGlvbihpZHgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU0FSRGV0ZWN0b3IuZ2V0SWRNYXJrZXJEYXRhKGlkeCk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnBhY2tldExlbmd0aCA+IDQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciByZXN1bHQ9MDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnBhY2tldExlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gKHJlc3VsdCA8PCA4KSB8IGRhdGEuZ2V0UGFja2V0RGF0YShpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBnZXRUcmFuc2Zvcm1NYXRyaXggPSBmdW5jdGlvbihpZHgpIHtcclxuICAgICAgICAgICAgdmFyIG1hdCA9IG5ldyBOeUFSVHJhbnNNYXRSZXN1bHQoKTtcclxuICAgICAgICAgICAgSlNBUkRldGVjdG9yLmdldFRyYW5zZm9ybU1hdHJpeChpZHgsIG1hdCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY20gPSBuZXcgRmxvYXQzMkFycmF5KDE2KTtcclxuICAgICAgICAgICAgY21bMF0gPSBtYXQubTAwO1xyXG4gICAgICAgICAgICBjbVsxXSA9IC1tYXQubTEwO1xyXG4gICAgICAgICAgICBjbVsyXSA9IG1hdC5tMjA7XHJcbiAgICAgICAgICAgIGNtWzNdID0gMDtcclxuICAgICAgICAgICAgY21bNF0gPSBtYXQubTAxO1xyXG4gICAgICAgICAgICBjbVs1XSA9IC1tYXQubTExO1xyXG4gICAgICAgICAgICBjbVs2XSA9IG1hdC5tMjE7XHJcbiAgICAgICAgICAgIGNtWzddID0gMDtcclxuICAgICAgICAgICAgY21bOF0gPSAtbWF0Lm0wMjtcclxuICAgICAgICAgICAgY21bOV0gPSBtYXQubTEyO1xyXG4gICAgICAgICAgICBjbVsxMF0gPSAtbWF0Lm0yMjtcclxuICAgICAgICAgICAgY21bMTFdID0gMDtcclxuICAgICAgICAgICAgY21bMTJdID0gbWF0Lm0wMztcclxuICAgICAgICAgICAgY21bMTNdID0gLW1hdC5tMTM7XHJcbiAgICAgICAgICAgIGNtWzE0XSA9IG1hdC5tMjM7XHJcbiAgICAgICAgICAgIGNtWzE1XSA9IDE7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY207XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZ2V0Q2FtZXJhTWF0cml4ID0gZnVuY3Rpb24oek5lYXIsIHpGYXIpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDMyQXJyYXkoMTYpO1xyXG4gICAgICAgICAgICBKU0FSUGFyYW1ldGVycy5jb3B5Q2FtZXJhTWF0cml4KHJlc3VsdCwgek5lYXIsIHpGYXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHBlcnNpc3RUaW1lID0gMTtcclxuICAgICAgICB2YXIgbmV3TWFya2VyID0gZnVuY3Rpb24oaWQsIG1hdHJpeCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgbWF0cml4OiBtYXRyaXgsXHJcbiAgICAgICAgICAgICAgICBhZ2U6IHBlcnNpc3RUaW1lLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWFya2VycyA9IHt9O1xyXG4gICAgICAgIHZhciBkZXRlY3QgPSBmdW5jdGlvbiggb25DcmVhdGUsIG9uVXBkYXRlLCBvbkRlc3Ryb3kgKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXJrZXJDb3VudCA9IEpTQVJEZXRlY3Rvci5kZXRlY3RNYXJrZXJMaXRlKEpTQVJSYXN0ZXIsIDcwKTsgXHJcbiAgICAgICAgICAgIGZvciggdmFyIGluZGV4ID0gMDsgaW5kZXggPCBtYXJrZXJDb3VudDsgaW5kZXgrKyApIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZCA9IGdldE1hcmtlck51bWJlcihpbmRleCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbWFya2Vyc1tpZF07XHJcbiAgICAgICAgICAgICAgICBpZiggbWFya2VyID09PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gbmV3TWFya2VyKGlkLCBnZXRUcmFuc2Zvcm1NYXRyaXgoaW5kZXgpKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzW2lkXSA9IG1hcmtlcjtcclxuICAgICAgICAgICAgICAgICAgICBvbkNyZWF0ZSggbWFya2VyICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXIubWF0cml4ID0gZ2V0VHJhbnNmb3JtTWF0cml4KGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYWdlID0gcGVyc2lzdFRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoIG1hcmtlciApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IoIHZhciBpZCBpbiBtYXJrZXJzICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbaWRdO1xyXG4gICAgICAgICAgICAgICAgaWYoIG1hcmtlciApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiggbWFya2VyLmFnZS0tID09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRGVzdHJveSggbWFya2VyICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtYXJrZXJzW2lkXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgIGRldGVjdDogZGV0ZWN0LFxyXG4gICAgICAgICAgICBnZXRDYW1lcmFNYXRyaXg6IGdldENhbWVyYU1hdHJpeFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjcmVhdGU6Y3JlYXRlXHJcbiAgICB9XHJcblxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUicsIGZ1bmN0aW9uKEFSQ2FtZXJhLCBBUkRldGVjdG9yLCBBUjNELCBBUk1hcmtlcikge1xyXG5cclxuICAgIHZhciBjYW52YXMsIGNvbnRleHQsIGRldGVjdG9yLCB2aWV3LCBhY3Rpb25zO1xyXG4gICAgdmFyIGluaXQ9ZnVuY3Rpb24oZ2xDYW52YXMsIG1hcmtlcl9hY3Rpb25zKXtcclxuXHJcbiAgICAgICAgbWFya2VyX2FjdGlvbnM9bWFya2VyX2FjdGlvbnMgfHx7fVxyXG4gICAgICAgIGFjdGlvbnM9e307IFxyXG5cclxuICAgICAgICBjYW52YXM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICB2YXIgY2FtZXJhRGltZW5zaW9ucz1BUkNhbWVyYS5nZXREaW1lbnNpb25zKCk7XHJcblxyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbWVyYURpbWVuc2lvbnMud2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbWVyYURpbWVuc2lvbnMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBjb250ZXh0PWNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG4gICAgICAgIGRldGVjdG9yPUFSRGV0ZWN0b3IuY3JlYXRlKGNhbnZhcyk7XHJcblxyXG4gICAgICAgIHZpZXc9QVIzRC5jcmVhdGUoZ2xDYW52YXMsIGNhbWVyYURpbWVuc2lvbnMsIGNhbnZhcyk7XHJcblxyXG4gICAgICAgIGFjdGlvbnMub25DcmVhdGU9QVJNYXJrZXIuUHJpbWl0aXZlKHZpZXcsIG1hcmtlcl9hY3Rpb25zLm9uQ3JlYXRlfHxBUk1hcmtlci5vbkNyZWF0ZSk7XHJcbiAgICAgICAgYWN0aW9ucy5vblVwZGF0ZT1BUk1hcmtlci5QcmltaXRpdmUodmlldywgbWFya2VyX2FjdGlvbnMub25VcGRhdGV8fEFSTWFya2VyLm9uVXBkYXRlKTtcclxuICAgICAgICBhY3Rpb25zLm9uRGVzdHJveT1BUk1hcmtlci5QcmltaXRpdmUodmlldywgbWFya2VyX2FjdGlvbnMub25EZXN0cm95fHxBUk1hcmtlci5vbkRlc3Ryb3kpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGljaz1mdW5jdGlvbigpe1xyXG4gICAgICAgIEFSQ2FtZXJhLmNvcHlUb0NvbnRleHQoY29udGV4dCk7XHJcbiAgICAgICAgY2FudmFzLmNoYW5nZWQ9dHJ1ZTtcclxuXHJcbiAgICAgICAgZGV0ZWN0b3IuZGV0ZWN0KGFjdGlvbnMub25DcmVhdGUsIGFjdGlvbnMub25VcGRhdGUsIGFjdGlvbnMub25EZXN0cm95KTtcclxuXHJcbiAgICAgICAgdmlldy51cGRhdGUoKTtcclxuICAgICAgICB2aWV3LnJlbmRlcigpO1xyXG5cclxuXHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXQ6aW5pdCxcclxuICAgICAgICB0aWNrOnRpY2tcclxuICAgIH1cclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoJ0FSTWFya2VyJywgZnVuY3Rpb24oQVJPYmplY3QpIHtcclxuXHJcbiAgICB2YXIgb2JqZWN0cz17XHJcbiAgICAgICAgMTY6IEFST2JqZWN0LmNyZWF0ZUJhc2ljQ3ViZSh7Y29sb3I6MHhDQzAwMDB9KSxcclxuICAgICAgICAzMjogQVJPYmplY3QuY3JlYXRlQmFzaWNDdWJlKHtjb2xvcjoweDAwQ0MwMH0pLFxyXG4gICAgICAgIDY0OiBBUk9iamVjdC5jcmVhdGVCYXNpY0N1YmUoe2NvbG9yOjB4MDAwMENDfSlcclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIG9uQ3JlYXRlPWZ1bmN0aW9uKHZpZXcsIG1hcmtlcil7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ3JlYXRlZFwiKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKG1hcmtlci5pZClcclxuICAgICAgICBcclxuICAgICAgICB2YXIgb2JqZWN0PW9iamVjdHNbbWFya2VyLmlkXTtcclxuICAgICAgICBcclxuICAgICAgICBvYmplY3Qucm90YXRpb24ueCArPSAwLjE7XHJcbiAgICAgICAgb2JqZWN0LnJvdGF0aW9uLnkgKz0gMC4xO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZpZXcuYWRkKG9iamVjdCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG9uVXBkYXRlPWZ1bmN0aW9uKHZpZXcsIG1hcmtlcil7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlXCIpXHJcbiAgICAgICAgY29uc29sZS5sb2cobWFya2VyLmlkKVxyXG5cclxuICAgICAgICB2YXIgb2JqZWN0PW9iamVjdHNbbWFya2VyLmlkXTtcclxuXHJcbiAgICAgICAgb2JqZWN0LnJvdGF0aW9uLnggKz0gMC4xO1xyXG4gICAgICAgIG9iamVjdC5yb3RhdGlvbi55ICs9IDAuMTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG9uRGVzdHJveT1mdW5jdGlvbih2aWV3LCBtYXJrZXIpe1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcInJlbW92ZVwiKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKG1hcmtlci5pZClcclxuXHJcbiAgICAgICAgdmFyIG9iamVjdD1vYmplY3RzW21hcmtlci5pZF07XHJcbiAgICAgICAgdmlldy5yZW1vdmUob2JqZWN0KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFByaW1pdGl2ZT1mdW5jdGlvbih2aWV3LCBjYil7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG1hcmtlcil7XHJcbiAgICAgICAgICAgIGNiKHZpZXcsIG1hcmtlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgUHJpbWl0aXZlOlByaW1pdGl2ZSxcclxuICAgICAgICBvbkNyZWF0ZTpvbkNyZWF0ZSxcclxuICAgICAgICBvblVwZGF0ZTpvblVwZGF0ZSxcclxuICAgICAgICBvbkRlc3Ryb3k6b25EZXN0cm95XHJcbiAgICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gIC5mYWN0b3J5KCdBUk9iamVjdCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICBjcmVhdGVCYXNpY0N1YmU6IGZ1bmN0aW9uKGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDEsIDEsIDEpO1xyXG4gICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XHJcbiAgICAgICAgICBjb2xvcjogY29sb3JcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgY3ViZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XHJcbiAgICAgICAgY3ViZS5wb3NpdGlvbi56ID0gLTU7XHJcbiAgICAgICAgcmV0dXJuIGN1YmU7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBjcmVhdGVQaG9uZ0N1YmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgxLCAxLCAxKTtcclxuICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IDB4N0ZDQzE5LFxyXG4gICAgICAgICAgc2hpbmluZXNzOiAyMzBcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgY3ViZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XHJcbiAgICAgICAgcmV0dXJuIGN1YmU7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBjcmVhdGVHcmFkaWVudFBsYW5lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICBjYW52YXMud2lkdGggPSAxMjg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IDEyODtcclxuXHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgICAgICB2YXIgZ3JhZGllbnQgPSBjb250ZXh0LmNyZWF0ZVJhZGlhbEdyYWRpZW50KGNhbnZhcy53aWR0aCAvIDIsIGNhbnZhcy5oZWlnaHQgLyAyLCAwLCBjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMiwgY2FudmFzLndpZHRoIC8gMik7XHJcblxyXG4gICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjEsICdyZ2JhKDIxMCwyMTAsMjEwLDEpJyk7XHJcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsICdyZ2JhKDI1NSwyNTUsMjU1LDEpJyk7XHJcblxyXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gZ3JhZGllbnQ7XHJcbiAgICAgICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNoYWRvd1RleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZShjYW52YXMpO1xyXG4gICAgICAgIHNoYWRvd1RleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgICB2YXIgc2hhZG93TWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgbWFwOiBzaGFkb3dUZXh0dXJlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHNoYWRvd0dlbyA9IG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KDMwMCwgMzAwLCAxLCAxKTtcclxuXHJcbiAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaChzaGFkb3dHZW8sIHNoYWRvd01hdGVyaWFsKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1lc2g7XHJcblxyXG4gICAgICB9LFxyXG5cclxuICAgICAgY3JlYXRlSWNvc2FoZWRyb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciByYWRpdXM9MTtcclxuICAgICAgICB2YXIgY29sb3IsIGYsIHAsIHZlcnRleEluZGV4LCBmYWNlSW5kaWNlcyA9IFsnYScsICdiJywgJ2MnXTtcclxuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuSWNvc2FoZWRyb25HZW9tZXRyeShyYWRpdXMsIDEpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdlb21ldHJ5LmZhY2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBmID0gZ2VvbWV0cnkuZmFjZXNbaV07XHJcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDM7IGorKykge1xyXG4gICAgICAgICAgICB2ZXJ0ZXhJbmRleCA9IGZbZmFjZUluZGljZXNbal1dO1xyXG4gICAgICAgICAgICBwID0gZ2VvbWV0cnkudmVydGljZXNbdmVydGV4SW5kZXhdO1xyXG4gICAgICAgICAgICBjb2xvciA9IG5ldyBUSFJFRS5Db2xvcigweGZmZmZmZik7XHJcbiAgICAgICAgICAgIGNvbG9yLnNldEhTTCgocC55IC8gcmFkaXVzICsgMSkgLyAyLCAxLjAsIDAuNSk7XHJcbiAgICAgICAgICAgIGYudmVydGV4Q29sb3JzW2pdID0gY29sb3I7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWF0ZXJpYWxzID0gW1xyXG5cclxuICAgICAgICAgIG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7XHJcbiAgICAgICAgICAgIGNvbG9yOiAweGZmZmZmZixcclxuICAgICAgICAgICAgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmcsXHJcbiAgICAgICAgICAgIHZlcnRleENvbG9yczogVEhSRUUuVmVydGV4Q29sb3JzLFxyXG4gICAgICAgICAgICBzaGluaW5lc3M6IDBcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcclxuICAgICAgICAgICAgY29sb3I6IDB4MDAwMDAwLFxyXG4gICAgICAgICAgICBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZyxcclxuICAgICAgICAgICAgd2lyZWZyYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZVxyXG4gICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgXTtcclxuICAgICAgcmV0dXJuIFRIUkVFLlNjZW5lVXRpbHMuY3JlYXRlTXVsdGlNYXRlcmlhbE9iamVjdChnZW9tZXRyeSwgbWF0ZXJpYWxzKTtcclxuICAgICAgfVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgfVxyXG4gIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KCdBUlV0aWxzJywgZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0pIHtcclxuXHJcbiAgICB2YXIgc2l6ZT1mdW5jdGlvbihlbGVtKXtcclxuICAgICAgICAgICAgZWxlbS53aWR0aD13aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgZWxlbS5oZWlnaHQ9d2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgc2l6ZTpzaXplLCBcclxuICAgICAgICBzZXRWaWRlb1NpemU6ZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgIHNpemUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZGVvJykpO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXJ0b29sa2l0JylcclxuICAgIC5mYWN0b3J5KFwiQXBpU2VydmljZVwiLCBmdW5jdGlvbigkcmVzb3VyY2UsICRsb2NhdGlvbil7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICAvL2VudjokbG9jYXRpb24uYWJzVXJsKCkuaW5kZXhPZihcImxvY2FsaG9zdFwiKT09LTE/XCJwcm9kXCI6XCJkZXZcIixcclxuICAgICAgICBlbnY6XCJwcm9kXCIsXHJcbiAgICAgICAgcHJvZDp7XHJcbiAgICAgICAgICAgIHByb3RvY29sOlwiaHR0cHNcIixcclxuICAgICAgICAgICAgaG9zdDpcInBpY2t5b3VyZGF5Lmhlcm9rdWFwcC5jb21cIixcclxuICAgICAgICAgICAgcG9ydDpcIlwiLFxyXG4gICAgICAgICAgICByb290OlwiYXBpXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRldjp7XHJcbiAgICAgICAgICAgIHByb3RvY29sOlwiaHR0cFwiLFxyXG4gICAgICAgICAgICBob3N0OlwibG9jYWxob3N0XCIsXHJcbiAgICAgICAgICAgIHBvcnQ6XCI1MDAwXCIsXHJcbiAgICAgICAgICAgIHJvb3Q6XCJhcGlcIlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEFwaVBhdGg6ZnVuY3Rpb24ocGF0aCl7XHJcbiAgICAgICAgICAgIHZhciBhcGk9dGhpc1t0aGlzLmVudl07XHJcbiAgICAgICAgICAgIHJldHVybiBhcGkucHJvdG9jb2wrXCI6Ly9cIithcGkuaG9zdCsoYXBpLnBvcnQhPT1cIlwiPyhcIjpcIithcGkucG9ydCk6XCJcIikrXCIvXCIrYXBpLnJvb3QrXCIvXCIrcGF0aDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXN0OmZ1bmN0aW9uKHBhdGgsIG1ldGhvZHMsIGRlZmF1bHRQYXJhbXMpe1xyXG4gICAgICAgICAgICB2YXIgcmVzb3VyY2U9JHJlc291cmNlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRBcGlQYXRoKHBhdGgpLFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdFBhcmFtcyB8fCB7fSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZHMgfHwge31cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeShcIkF1dGhJbnRlcmNlcHRvclwiLCBmdW5jdGlvbigkcSwgJGxvY2F0aW9uKXtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24oY29uZmlnKXtcclxuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcclxuXHJcbiAgICAgICAgICAgIHZhciB1c2VyPWdldEpTT05Mb2NhbChcInVzZXJcIik7XHJcbiAgICAgICAgICAgIHZhciB1c2VyPWdldEpTT05Mb2NhbChcInVzZXJcIik7XHJcbiAgICAgICAgICAgIGlmICghY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiAmJiB1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gdXNlci50b2tlbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXF1ZXN0RXJyb3I6IGZ1bmN0aW9uKHJlamVjdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlamVjdGlvbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gJ0VSUk9SJykgeyAvL0ZvcmNlIGVycm9yXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNwb25zZUVycm9yOiBmdW5jdGlvbihyZWplY3Rpb24pe1xyXG4gICAgICAgICAgICBpZihyZWplY3Rpb24uc3RhdHVzID09PSA0MDMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlIGFjY2VzbycpO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnVzZXIgPSAnJztcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcnRvb2xraXQnKVxyXG4gICAgLmZhY3RvcnkoXCJPYXV0aFNlcnZpY2VcIiwgZnVuY3Rpb24oQXBpU2VydmljZSl7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuXHJcbiAgICAgICAgYmFzZTpcIm9hdXRoXCIsXHJcbiAgICAgICAgbG9naW46ZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcmV0dXJuIEFwaVNlcnZpY2UucmVzdCh0aGlzLmJhc2Use1xyXG4gICAgICAgICAgICAgICAgU2Vzc2lvbjp7bWV0aG9kOlwiUE9TVFwiLCBwYXJhbXM6e319XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG9nb3V0OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnJlc3QodGhpcy5iYXNlK1wiL2xvZ291dFwiLCB7XHJcbiAgICAgICAgICAgICAgICBTZXNzaW9uOnttZXRob2Q6XCJHRVRcIiwgcGFyYW1zOnt9fVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJvbGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcmV0dXJuIEFwaVNlcnZpY2UucmVzdCh0aGlzLmJhc2UrXCIvcm9sZS86cm9sZVwiLCB7XHJcbiAgICAgICAgICAgICAgICAgIGNoZWNrOnttZXRob2Q6XCJHRVRcIiwgcGFyYW1zOntyb2xlOlwiQHJvbGVcIn19LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxufSk7XHJcblxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FydG9vbGtpdCcpXHJcbiAgICAuZmFjdG9yeShcIlJlcXVlc3RTZXJ2aWNlXCIsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgIFxyXG4gICAgICAgIFNlcnZlck5vdEZvdW5kOiBDbG9zdXJlTWVzc2FnZShcIlNlcnZlciBOb3QgRm91bmRcIiksXHJcblxyXG4gICAgICAgIE5vUm9sZUF1dGhvcml6ZWQ6IENsb3N1cmVNZXNzYWdlKFwiTm8gUm9sZSBBdXRob3JpemVkXCIpLFxyXG4gICAgICAgIFxyXG4gICAgXHJcbiAgICB9O1xyXG59KTtcclxuIl19
