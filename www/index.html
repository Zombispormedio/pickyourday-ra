<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <!--<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'"/>-->
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>

    <script id="shader-vs" type="x-shader/x-vertex">
        attribute vec2 a_position; varying vec2 uv; void main() { uv=0.5*vec2(1.0+a_position.x, 1.0+a_position.y); gl_Position =
        vec4(a_position, 0, 1); }
    </script>

    <script id="shader-fs" type="x-shader/x-fragment">
        precision mediump float;
         uniform sampler2D src;
           varying vec2 uv;
          void main(){ 
        gl_FragColor = vec4(0, 1, 0, 1); 
        // gl_FragColor=texture2D(src, uv); 
        }

    </script>

</head>

<body ng-app="starter">

    <ion-pane>
        <ion-header-bar class="bar-stable">
            <h1 class="title">Ionic Blank Starter</h1>
        </ion-header-bar>
        <ion-content>
            <canvas id="canvas"></canvas>
            <video id="video"></video>
        </ion-content>
    </ion-pane>
    <script>
        (function() {
              var streaming = false, video= document.getElementById('video'), width = 320,
      height = 0;
               navigator.getMedia = ( navigator.getUserMedia ||
                         navigator.webkitGetUserMedia ||
                         navigator.mozGetUserMedia ||
                         navigator.msGetUserMedia);
                         
                         navigator.getMedia({video: true,audio: false},
                         function(stream) {
                                if (navigator.mozGetUserMedia) {
                                        video.mozSrcObject = stream;
                                } else {
                                         var vendorURL = window.URL || window.webkitURL;
                                        video.src = vendorURL.createObjectURL(stream);
                                    }
                                 video.play();
                            },
                        function(err) {

                             console.log("An error occured! " + err);
                        });
                        video.addEventListener('canplay', function(ev){
                               if (!streaming) {
                                height = video.videoHeight / (video.videoWidth/width);
                                video.setAttribute('width', width);
                                video.setAttribute('height', height);
                                 initWebGl(video);
                                streaming = true;
                        }
                        }, false);
        })();
    </script>
</body>

</html>